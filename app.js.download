"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e});var C,b,S,x,L,I,M,w,A,k,N,_,O,R,D,P,B,U,F,o,l,H,V,z,e,q,u,t,G,W,j,K,J,Y,d,i,c,n,Q,p,Z,X,r,ee,te,ne,ae,s,m,f,g=13,v=27,h="_kenytUserId_",oe="_kenytviewstate_",y="MessageHub",ie="_kenytsessionstate_",E=":",T={CONTACT_FORM:{Trigger:"Open Lead Form"},APPOINTMENT_FORM:{Trigger:"Open Appointment Form"},ADDRESS_FORM:{Trigger:"Open Address Form"},LATLONG_FORM:{Trigger:"Open GeoLocation Form"},FIREBASE_FORM:{Trigger:"Open firebase Form"},FILE_UPLOAD:{Trigger:"Open Upload Form"},CALLER:{Trigger:"Open Caller"},OTP:{Trigger:"Open OTP Form"},GENERIC_FORM:{Trigger:"Open Generic Form"},NAVIGATE:{Trigger:"NavigateTo",Pattern:/^NavigateTo\s*:\s*\[.*\]\(.*\)$/i},SETTINGS_OVERRIDE:{Trigger:"UpdateUxSettings",Pattern:/^UpdateUxSettings\s*:\s*.*$/i},SET_LANGUAGE:{Trigger:"Set Language"},SET_SESSION:{Trigger:"Set Session"},NOTIFY_LEAD_CAPTURE:{Trigger:"Notify Lead Capture"},OPEN_RAZORPAY_BUTTON:{Trigger:"Open Razorpay Button"}},re="phone::",se="Intl Tel Input Plugin",le="../ChatbotUI/external/IntlTelInput/utils.js",de="_EMPTY_",ce="en",ue="kenytUnreadMessage",pe=/(http|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/i,me=/\[.*\]\(.*\)/,fe=/[\d]{4,}/,ge={TRACKING_ID:"UA-64989543-27",EVENT_INITIAL_LOAD:"initial_event",EVENT_DOCUMENT_READY:"document_ready",EVENT_COOKIES_DISABLED:"cookies_disabled",EVENT_LOAD_CHAT_REQUESTED:"load_chatbot_requested",EVENT_LOAD_CHAT_RECEIVED:"load_chatbot_received",EVENT_LOAD_CHAT_INTIME:"load_chatbot_intime",EVENT_VALID_BOT_ID:"valid_botid",EVENT_AUTO_MESSAGE_REQUESTED:"auto_message_requested",EVENT_AUTO_MESSAGE_SKIPPED:"auto_message_skipped",EVENT_AUTO_MESSAGE_RECEIVED:"auto_message_received",EVENT_FIRST_USER_REQUEST:"first_user_request",EVENT_INITIALIZE_CONNECTION:"initialize_connection",EVENT_FIRST_BOT_RESPONSE:"first_bot_response",EVENT_MESSAGE_SENT:"client_message_sent",EVENT_MESSAGE_RECEIVED:"client_message_received",EVENT_MESSAGE_DELAY:"reply_delay",EVENT_MESSAGE_UNSUCCESSFUl:"client_message_unsuccessful",EVENT_MESSAGE_ABANDONED:"client_message_abandoned",EVENT_MESSAGE_FAILED:"client_message_failed",EVENT_LOCATION_OBTAINED:"location_obtained",EVENT_LOCATION_DENIED:"location_denied",DISCONNECT_IDLE_USER:"disconnect_idle_user"},ve=750,he="/signalr",ye="/api/botsetup/loadchatwindow",Ee="",Te="",Ce="/botapp",be={PROD:"/dashboard",LOCAL:"http://localhost:4200"},Se=5,xe=3,Le=1440,Ie={TYPING_INDICATOR:"TypingIndicator",SENDER_DETAILS:"MessageSenderInfo",OTP_FORM:"OTPForm",PHONE_NUMBER_FORM:"PhoneNumberForm",SHOW_MORE_BUTTON:"ShowMoreButton",SMALL_BUTTON_CARD:"SmallButtonCard",MEDIUM_BUTTON_CARD:"MediumButtonCard",VISITING_CARD:"VisitingCard",VERTICAL_CARD:"VerticalCard",CARD_BUTTON:"CardButton",HEADER_MENU_ITEM:"HeaderMenuItem",FILE_CARD:"FileCard",LOCATION_CARD:"LocationCard",FOOTER_MENU:"FooterMenu",INTERACTIVE_CARD:"InteractiveList",INTERACTIVE_MENU_CARD:"ShowInteractiveMenuButton"},Me="enable-on-bot-reply",we=[{text:"Afrikaans",value:"af",displayText:"Afrikaans"},{text:"Albanian",value:"sq",displayText:"shqipe"},{text:"Amharic",value:"am"},{text:"Arabic",value:"ar",displayText:"العَرَبِيَّة"},{text:"Armenian",value:"hy",displayText:"Հայերեն"},{text:"Azerbaijani",value:"az",displayText:"azərbaycan dili"},{text:"Basque",value:"eu",displayText:"euskara"},{text:"Belarusian",value:"be",displayText:"беларуская мова"},{text:"Bengali",value:"bn",displayText:"বাংলা"},{text:"Bosnian",value:"bs",displayText:"Bosanski Jezik"},{text:"Bulgarian",value:"bg",displayText:"български език"},{text:"Catalan",value:"ca",displayText:"català"},{text:"Cebuano",value:"ceb",displayText:"Cebuano"},{text:"Chadic",value:"ha",displayText:"Harshen Hausa"},{text:"Chinese (Mandarin)",value:"zh-CN",displayText:"中文"},{text:"Chinese(Traditional)",value:"zh-TW"},{text:"Corsican",value:"co",displayText:"Espanol - CO"},{text:"Croatian",value:"hr",displayText:"Hrvatski Jezik"},{text:"Czech",value:"cs",displayText:"český jazyk"},{text:"Danish",value:"da",displayText:"Dansk"},{text:"Dutch",value:"nl",displayText:"Nederlands"},{text:"English",value:"en"},{text:"Esperanto",value:"eo",displayText:"Esperanto"},{text:"Estonian",value:"et",displayText:"Eesti"},{text:"Filipino",value:"fl",displayText:"Pilipino"},{text:"Finnish",value:"fi",displayText:"Suomi"},{text:"French",value:"fr",displayText:"Français"},{text:"Frisian",value:"fy"},{text:"Galician",value:"gl",displayText:"Galego"},{text:"Georgian ",value:"ka",displayText:"ქართული"},{text:"German",value:"de",displayText:"Deutsch"},{text:"Greek",value:"el",displayText:"ελληνικά"},{text:"Gujarati",value:"gu",displayText:"ગુજરાતી"},{text:"Haitian Creole",value:"ht",displayText:"Kreyol Ayisyen"},{text:"Hausa",value:"ha ",displayText:"هَوُسَ"},{text:"Hawaiian",value:"haw"},{text:"Hebrew",value:"he",displayText:"עברית"},{text:"Hindi",value:"hi",displayText:"हिन्दी"},{text:"Hmong",value:"hmn",displayText:"Hmong"},{text:"Hungarian",value:"hu",displayText:"magyar"},{text:"Icelandic",value:"is",displayText:"Islenka"},{text:"Igbo",value:"ig",displayText:"Ásụ̀sụ̀"},{text:"Indonesian",value:"id",displayText:"Indonesia"},{text:"Irish",value:"ga",displayText:"Gaeilge"},{text:"Italian",value:"it",displayText:"Italiano"},{text:"Japanese",value:"ja",displayText:"日本語"},{text:"Javanese",value:"jv",displayText:"Basa Jawa"},{text:"Javanese",value:"jw"},{text:"Kannada",value:"kn",displayText:"ಕನ್ನಡ"},{text:"Kazakh",value:"kk",displayText:"қазақ тілі"},{text:"Khmer",value:"km    ",displayText:"ខ្មែរ,"},{text:"Korean",value:"ko",displayText:"한국어"},{text:"Kurdish",value:"ku"},{text:"Kyrgyz",value:"ky"},{text:"Lao",value:"lo",displayText:"ພາສາລາວ"},{text:"Latin",value:"la",displayText:"Latine"},{text:"Latvian",value:"lv",displayText:"latviešu valoda"},{text:"Lithuanian",value:"lt",displayText:"lietuvių kalba"},{text:"Luxembourgish",value:"lb"},{text:"Macedonian",value:"mk",displayText:"македонски јазик"},{text:"Malagasy",value:"mg",displayText:"Malagasy"},{text:"Malay",value:"ms",displayText:"Bahasa Melayu"},{text:"Malayalam",value:"ml",displayText:"മലയാളം"},{text:"Maltese",value:"mt",displayText:"Malti"},{text:"Maori",value:"mi",displayText:"Māori"},{text:"Marathi",value:"mr",displayText:"मराठी"},{text:"Mongolian",value:"mn",displayText:"монгол"},{text:"Myanmar(Burmese)",value:"my"},{text:"Nepali",value:"ne",displayText:"नेपाली"},{text:"Norwegian",value:"no",displayText:"Norsk"},{text:"Nyanja",value:"ny",displayText:"Chichewa"},{text:"Odia",value:"or",displayText:"ଓଡିଆ"},{text:"Pashto",value:"ps"},{text:"Persian",value:"fa"},{text:"Polish",value:"pl",displayText:"Polski"},{text:"Portuguese(Portugal, Brazil)",value:"pt",displayText:"Português"},{text:"Punjabi",value:"pa",displayText:"ਪੰਜਾਬੀ"},{text:"Romanian",value:"ro",displayText:"limba română "},{text:"Russian",value:"ru",displayText:"русский язык"},{text:"Samoan",value:"sm"},{text:"Scots Gaelic",value:"gd",displayText:"Gàidhlig na h-Alba"},{text:"Serbian",value:"sr",displayText:"српски језик"},{text:"Shona",value:"sn"},{text:"Sindhi",value:"sd"},{text:"Sinhala(Sinhalese)",value:"si",displayText:"සිංහල"},{text:"Slovak",value:"sk",displayText:"slovenčina"},{text:"Slovenian",value:"sl",displayText:"Slovenski Jezik"},{text:"Somali",value:"so",displayText:"Soomaali"},{text:"Spanish",value:"es",displayText:"Español"},{text:"Southern Sotho",value:"st",displayText:"Sesotho"},{text:"Sundanese",value:"su",displayText:"Basa Sunda"},{text:"Swahili",value:"sw",displayText:"Kiswahili"},{text:"Swedish",value:"sv",displayText:"Sverige"},{text:"Tagalog(Filipino)",value:"tl"},{text:"Tajik",value:"tg",displayText:"тоҷикӣ"},{text:"Tamil",value:"ta",displayText:"தமிழ்"},{text:"Telugu",value:"te",displayText:"తెలుగు"},{text:"Thai",value:"th",displayText:"ไทย"},{text:"Turkish",value:"tr",displayText:"Türkçe"},{text:"Ukrainian",value:"uk",displayText:"українська мова"},{text:"Urdu",value:"ur",displayText:"اُردُو"},{text:"Uzbek",value:"uz",displayText:"Oʻzbek"},{text:"Vietnamese",value:"vi",displayText:"Tiếng Việt"},{text:"Welsh",value:"cy"},{text:"Xhosa",value:"xh"},{text:"Yiddish",value:"yi",displayText:"ייִדיש"},{text:"Yoruba",value:"yo",displayText:"Ede Yorùbá"},{text:"Zulu",value:"zu",displayText:"isiZulu"}],Ae={EMAIL_VALIIDATION_PATTERN:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,10}|[0-9]{1,5})(\]?)$/,PHONE_VALIDATION_SOURCE:se,URL_VALIIDATION_PATTERN:/^(http[s]?:\/\/)?(www\.)?(\w)+\.(\w)+([\/.][\w-#]*)*$/},ke=xa(),Ne=ke+he,_e=ke+ye,Oe=ke+"/api/file/upload",Re={None:0,Thumbnail:1,Hero:2,Image:3,Gif:4,Video:5,QuickLink:6,SmallButton:7,MediumButton:8,VisitingCard:9,VerticalCard:10,Location:11,File:12,FooterMenu:13,InteractiveList:101},De={UserMessage:1,AutoMessage:2,ManualMessage:3},Pe={UnreadMessage:"kenytUnreadMessage",ChatWindowClose:"kenytChatWindowClose",ChatWindowOpen:"kenytChatWindowOpen",FullScreenImage:"kenytFullScreenImage",NavigateToPage:"kenytNavigateToPage",ToggleFullScreen:"kenytToggleFullscreen",ForceFullHeight:"kenytForceFullHeight",TextColor:"kenytTextColor",IsWindowMinimizedResponse:"kenytIsWindowMinimizedResponse",GetPageTitle:"kenytPageTitle",GetReferrer:"kenytPageReferrer",Initialize:"kenytInitialize",FirebaseToken:"getFirebaseToken",PageInfoRequest:"kenytPageInfoRequest",PageInfoResponse:"kenytPageInfoResponse",CustomEventDispatch:"kenytCustomEventDispatch",SettingsUpdate:"kenytSettingsUpdate",UpdateChatBubbleColor:"kenytUpdateChatBubbleColor",UpdateAttentionMessage:"kenytUpdateAttentionMessage",UpdateBotPosition:"kenytUpdateBotPosition",MediaStreamingCommand:"kenytMediaStreamingCommand",SendMessage:"kenytSendMessage",ReportGoogleAnalyticsEvent:"reportGoogleAnalyticsEvent",OpenRazorpayForm:"kenytOpenRazorpayForm",SubmitRazorpayPayment:"kenytSubmitRazorpayPayment"},Be={Load:"kenyt_Load",ChatStart:"kenyt_ChatStart",ContactFormSubmit:"kenyt_ContactFormSubmit",UserMessage:"kenyt_UserMessage"},Ue={Form:"Form"},Fe={SessionCount:1},He=!1,Ve={},ze={},qe=!0,Ge={},We=!1,je={pageStartAt:null,isSkipped:!0,isSent:!1,isSentAck:!1,isReceived:!1,sentAt:null,receivedAt:null},$e={FrameColor:"",FrameColorGradient:"",HeaderTitle:"Automated Live Chat",HeaderSubTitle:"Online",EnableSpeech:"False",HeaderFontSize:"",HeaderTextColor:"#ffffff",FontSize:"",FontFamily:"",UserChatBubbleColor:"",UserChatBubbleColorGradient:"",BotChatBubbleColor:"#ffffff",PlaceholderText:"Type your message...",ShowPoweredBy:"True",PoweredBy:{},BotTextColor:"#000",UserTextColor:"#000",BackgroundImage:"",BackgroundColor:"",CustomPanelCss:"",AvatarImage:"/api/botsetup/getimage?imagetype=chatbubble-icon&botid=",DesktopMinimizeBotAtStart:"True",MobileMinimizeBotAtStart:"True",OpenWindowAfterMilliSeconds:"0",Languages:"",UserPersona:"you",BotPersona:"chatbot",AttentionMessage:"",LiveAgentCall:"False",HideMenuInHeader:"False",EnableChatRestart:"False",IdleTimeSeconds:0},Ke={adaptiveHeight:!0,dots:!1,mobileFirst:!0,arrows:!0,autoplay:!0,autoplaySpeed:5e3},Je=[],Ye={},Qe={headerMenu:{container:null,content:null},footerMenu:{container:null,content:null}},Ze=[],Xe=!1,et=!0,tt=1,nt=1,at=!1,ot=!1,it=!1,rt={senderDetailsView:null,indicatorView:null},st={"See Details":"See Details",Submit:"Submit","None of the above":"None of the above","Contact Information":"Contact Information","Please enter your contact details":"Please enter your contact details",Name:"Name",Email:"Email",Phone:"Phone",Mobile:"Mobile"},lt={},dt={};function ct(e){if(e)for(var t in e)dt[t]=e[t]}ct(st);var ut,pt,mt,ft,gt={audio:!0},vt=null,ht={},yt=!1,Et=null,Tt={lastFocusedAt:null,idleTimeSec:0};function Ct(e){Lt("event",ge.EVENT_LOAD_CHAT_RECEIVED),ht.receivedAt=new Date;var t=!1;try{var n=JSON.parse(e.target.response);if(n){if(G=n.IsTest,n.OrgBot&&(p=n.OrgBot,Lt("event",ge.EVENT_VALID_BOT_ID)),n.ConversationId&&jt(n.ConversationId),n.Response&&(Ft(n.Response),Lt("event",ge.EVENT_AUTO_MESSAGE_RECEIVED)),n.InitializeConnection&&(t=!0),n.WindowConfiguration&&(F=Jt(n.WindowConfiguration),yt=F.EnableChatRestart,jn(F),lt.HeaderTitle=F.HeaderTitle||$e.HeaderTitle,lt.HeaderSubTitle=F.HeaderSubTitle||$e.HeaderSubTitle),n.QueryUserDetails){var a=document.createElement("div"),o=document.createElement("p");if(o.innerText="Would you like to continue as",a.appendChild(o),n.QueryUserDetails.MaskedEmail){var i=document.createElement("p");i.innerText=n.QueryUserDetails.MaskedEmail,a.appendChild(i)}if(n.QueryUserDetails.MaskedPhone){var r=document.createElement("p");r.innerText=n.QueryUserDetails.MaskedPhone,a.appendChild(r)}var s=document.createElement("div");s.classList.add("card-thumbnail","text-center","mt-1"),a.appendChild(s);var l=document.createElement("div");l.classList.add("option-pill","pointer"),l.innerText="Yes",s.appendChild(l);var d=document.createElement("div");d.classList.add("option-pill","pointer"),d.innerText="No",s.appendChild(d),l.addEventListener("click",function(e){n&&n.QueryUserId&&Wt(n.QueryUserId),window.setTimeout(function(){Qt("",null,!0,!0)},0),l.disabled=!0,d.disabled=!0}),d.addEventListener("click",function(e){u=!0,n&&n.SessionUserId&&Wt(n.SessionUserId),window.setTimeout(function(){Qt("",null,!0,!0)},0),l.disabled=!0,d.disabled=!0});var c=oa();c.classList.add("w-95"),c.appendChild(a),Gn(c)}else n.SessionUserId&&Wt(n.SessionUserId);n.LanguageSettings&&$t(n.LanguageSettings)}}catch(e){e.message="load chatbot error:: "+(e&&e.message||""),It(e)}(t&&wt(),ht.requestedAt&&ht.receivedAt)&&((ht.receivedAt.valueOf()-ht.requestedAt.valueOf())/1e3<xe&&Lt("event",ge.EVENT_LOAD_CHAT_INTIME))}function bt(){window.navigator.geolocation&&window.navigator.geolocation.getCurrentPosition(function(e){console.debug(e),f=e.coords,Lt("event",ge.EVENT_LOCATION_OBTAINED),Qt("Coordinates::"+e.coords.latitude+" "+e.coords.longitude)},function(e){Qt("Coordinates denied by user"),console.warn("[Kenyt.AI] Location permission denied"),Lt("event",ge.EVENT_LOCATION_DENIED)},{enableHighAccuracy:!0})}function St(){Fa(Pe.FirebaseToken)}function xt(e,t){return t=t||window.location.href,new URL(t).searchParams.get(e)}function Lt(){window.dataLayer.push(arguments)}function It(e,t){var n=e&&e.lineno||"0",a=e&&e.colno||"0",o="["+(e&&e.filename||"unknown-file")+":"+n+":"+a+"] "+(e&&e.message||"null");ba()||Lt("event","exception",{description:o,fatal:t||!1}),console.debug(new Date+" "+o)}function Mt(){var e=xt("botid");ba()&&(window["ga-disable-"+ge.TRACKING_ID]=!0),Lt("js",new Date);var t=xt("googleAnalyticsId");t||(t=ge.TRACKING_ID),Lt("config",t,{custom_map:{dimension1:"botClientId"}}),e&&Lt("event",ge.EVENT_INITIAL_LOAD,{botClientId:e}),window.addEventListener("error",function(e){It(e,!1)})}function wt(){Ka("Initializing connection");(o=$.hubConnection(Ne)).qs="botid="+z,ba()&&(o.logging=!0),o.connectionSlow(function(){console.warn("[Kenyt.AI] Connection is slow, may get disconnected"),Lt("event","connection_slow",Za("connection"))}),o.reconnecting(function(){X.tryingToReconnect=!0,X.isConnected=!1,X.reason="Reconnecting",Ka("Reconnecting..."),console.warn("[Kenyt.AI] Lost connection to server, trying to reconnect..."+new Date),Lt("event","connection_lost",Za("connection"))}),o.reconnected(function(){X.tryingToReconnect=!1,X.isConnected=!0,Ka(X.reason="Reconnected"),Ja(),console.warn("[Kenyt.AI] Reconnected to server..."+new Date),Lt("event","reconnected",Za("connection")),ja()}),(l=o.createHubProxy(y)).on("BotReply",Ft),l.on("ManualReply",Ht),l.on("Error",Gt),l.on("NotifyAgentJoin",Io),l.on("NotifyAgentExit",Mo),l.on("NotifyWebRtcSignal",Qo),l.on("ChangeLanguage",$t),At(Dt,Pt,!1),o.disconnected(function(){if(o.lastError){var e=new Date;console.log("Disconnected at "+e),console.log("Disconnected. Reason: "+o.lastError.message);var t=void 0;t=X.tryingToReconnect?"Disconnected after reconnecting failed;":"Disconnected without reconnecting;",t=o.lastError.message||t,console.error("[Kenyt.AI] "+t),X.isConnected=!1,X.tryingToReconnect=!1,X.reason="disconnected",Ja(),ae&&(Ka("Connection disconnected, Reconnecting in 5 secs..."),window.setTimeout(function(){wt()},5e3),t="(Reconnecting) "+t),It({message:"Connection Disconnected: "+t},!0)}})}function At(e,t,n){n?(Lt("event","forced_longpolling"),o.start({transport:"longPolling"}).done(e).fail(t)):o.start().done(e).fail(t)}function kt(){w.addEventListener("keydown",zn),w.addEventListener("focus",function(){Qa()&&lo(),qa(I)}),k.addEventListener("click",qn),N.addEventListener("click",ko),_&&_.addEventListener("click",function(e){No()}),B.addEventListener("click",function(e){e.stopPropagation(),Ot();var t=B.getAttribute("data-toggle");io(),Lt("event","Button_Minimize_Maximize",Za("user_interaction",null,t))}),U.addEventListener("click",ta),window.addEventListener("beforeunload",Bt),L.addEventListener("click",ta),x.addEventListener("click",ta),S.parentElement.addEventListener("click",ta),document.addEventListener("keydown",function(e){var t=void 0;"key"in e?"Escape"!==e.key&&"Esc"!==e.key||(t=!0):t=e.keyCode===v,t&&ta(),Ot()}),document.addEventListener("click",function(e){Ot()}),window.addEventListener("message",function(e){if("object"===a(e.data)&&e.data.type){var t=e.data;if(t.type===Pe.IsWindowMinimizedResponse)qe=t.value,ha();else if(t.type===Pe.GetPageTitle)Ge.pageTitle=t.value;else if(t.type===Pe.GetReferrer)Ge.pageReferrer=t.value;else if(t.type===Pe.PageInfoResponse)t.value&&Ya(t.value);else if(t.type===Pe.SettingsUpdate)t.value&&jn(t.value,!1,!0);else if(t.type===Pe.MediaStreamingCommand)Zo(t.value);else if(t.type===Pe.SendMessage){var n=t.value;n.messageToSend?Yt(n):Qt(n,"",!1,!0)}else if(t.type===Pe.ReportGoogleAnalyticsEvent)ba()||(t.value.isException?Lt("event",t.value.eventName,t.value.details):Lt("event",t.value.eventName));else if(t.type===Pe.SubmitRazorpayPayment){Yt({messageToSend:"Kcomplete paymenttransaction",displayMessage:"Payment completed",payload:t.value}),Jo.removeRazorpayButton()}else t.type===Pe.FirebaseToken&&t.value&&Qt("save firebase app token","",!1,!1,!1,IframeEvent.value)}})}function Nt(){if(o)try{o.stop()}catch(e){console.debug("Manual disconnection failed")}}function _t(){var e=document.hasFocus();Tt&&Tt.idleTimeSec&&X.isConnected&&Tt.lastFocusedAt&&!e&&(((new Date).valueOf()-Tt.lastFocusedAt.valueOf())/1e3>Tt.idleTimeSec&&(Nt(),Lt("event",ge.DISCONNECT_IDLE_USER),X.isConnected=!1,X.tryingToReconnect=!1,X.reason="idle",Ja(),Ka("Connection disconnected (Idle User)",!0),document.getElementById("chatWindow").addEventListener("focus",Rt)))}function Ot(){Tt&&(Tt.lastFocusedAt=new Date),Rt()}function Rt(){document.getElementById("chatWindow").removeEventListener("focus",Rt),!X.isConnected&&X.reason&&"idle"===X.reason&&wt()}function Dt(){if(We=!1,Lt("event",o&&o.transport&&o.transport.name||"unknown",Za("transport_type")),Ja(),X.isConnected=!0,X.tryingToReconnect=!1,p){var e={BotClientId:p.BotId,Conversation:{ConversationId:V},User:{UserId:H}};l.invoke("Subscribe",e),ja()}}function Pt(e){console.debug("connection failed"),console.debug(arguments),e.message=e.message||"",e.message="Failed Server Connection: "+e.message,It(e)}function Bt(){Nt();var e=Ea();e&&e.messages&&(ee=e.messages),ha()}function Ut(){}function Ft(t){if(console.debug(t),t){if(i=new Date,d){var e=(i.valueOf()-d.valueOf())/1e3;xe<e&&Lt("event",ge.EVENT_MESSAGE_DELAY,Za("messages",null,e))}m&&!s&&(s=!0,Lt("event",ge.EVENT_FIRST_BOT_RESPONSE)),t.ClearChat&&Eo(),mn(t.BotMenu),t.Messages&&0<t.Messages.length?(t.Messages.forEach(function(e){e.DisplayName=t.DisplayName,e.IsPartial=t.IsPartial,on(e)}),ha()):en(),ae&&Lt("event",ge.EVENT_MESSAGE_RECEIVED,Za("messages"));var n=document.getElementsByClassName(Me);if(n)for(var a=0;a<n.length;a++)zt(n[a])}}function Ht(e){var t={Text:e.Text,RichCards:[],CardsType:Re.None,DisplayName:e.SenderName};t.Text&&T.SETTINGS_OVERRIDE.Pattern.test(t.Text.trim())?jn(fo(t.Text),!0):(t.Text&&(dn(t),Ga(t.Text)),e.Suggestion&&(e.Suggestion.DisplayName=e.SenderName,dn(e.Suggestion),Ga(e.Suggestion.Text)))}function Vt(e,t,n,a){console.debug("Received values from form"),console.debug(t),qt(e.target,[Me]);var o={},i=!0;t.forEach(function(e){var t=e.inputElementRef?e.inputElementRef.value:"";if(t&&"checkbox"===e.datatype&&(e.inputElementRef.checked||(t="")),e.isMandatory||da(t)){e.validationPattern&&!So(e.validationPattern)&&(e.validationPattern=new RegExp(e.validationPattern));var n=!0;n=e.validationPattern?e.validationPattern.test(t):da(t),e.validationSource&&e.pluginObj&&e.validationSource===se&&(n=e.pluginObj.isValidNumber(),t=e.pluginObj.getNumber()),n?(console.debug("Setting User."+e.field+" = "+t),Pa(e),o[e.field]=t):(console.debug("Form not valid"),Ba(e),i=!1)}});var r=!0;if(i)if(n)if(a&&"values"===a){var s=[];Object.keys(o).forEach(function(e){s.push(""+o[e])});var l=s.join("\n");da(l)&&(Qt(n,null,!1,!1,!1,l),r=!1)}else 0<Object.keys(o).length&&(Qt(n,null,!1,!1,!1,o),r=!1);else{var d=Ua(o);da(d)&&(Qt(d,null,!1,!0),r=!1)}r&&zt(e.target)}function zt(e){e&&e.classList&&(e.disabled=!1,e.classList.remove(Me))}function qt(t,e){t&&t.classList&&(t.disabled=!0,e&&e.forEach(function(e){return t.classList.add(e)}))}function Gt(e){console.error(e),e&&(e.message=e.message||"",e.message="Handle Error: "+e.message),It(e)}function Wt(e){return console.debug("Received UserId: "+e),H=e,ha(),!0}function jt(e){return console.debug("Received ConversationId: "+e),V=e,Fa(Pe.Initialize,V),ha(),!0}function $t(e){if(e){if(console.debug("Received language settings from server"),console.debug(e),e.LanguageCode&&Xa(e.LanguageCode,e.PreventHiMessage),e.Personas&&!xo(e.Personas))for(var t in e.Personas)uo(t,e.Personas[t],!0);else uo("user",F.UserPersona,!0),uo("bot",F.BotPersona,!0);ct(e.Buttons&&!xo(e.Buttons)?e.Buttons:st);var n=void 0;n=e.WindowContents&&!xo(e.WindowContents)?e.WindowContents:lt,e.WindowContents&&(jn(n,!0),Fa(Pe.UpdateAttentionMessage,n.AttentionMessage)),Kt(e.RightToLeft)}}function Kt(e){var t=e?"rtl":"ltr";document.documentElement&&document.documentElement.setAttribute("dir",t)}function Jt(a){var o={};return a&&Object.keys(a).forEach(function(e){var t=a[e].Value,n=a[e].Key;n in $e&&(o[n]=t)}),o}function Yt(e){Qt(e.messageToSend,e.displayMessage,e.isAutoMessage,e.preventMessageRender,e.isHidden,e.payload,e.payloadType)}function Qt(e,t,n,a,o,i,r){if(n||!e||0!==e.trim().length){n||Ot();var s=void 0;if(t&&!a){s=aa(t,'<span class="fa fa-spin fa-circle-o-notch"></span> sending..'),"user"!==c&&(ro("user",Va(),!0),c="user"),Gn(s),Xt(ze.name)}var l={RequestType:n?De.AutoMessage:De.UserMessage,Text:e,BotClientId:p?p.BotId:0,Conversation:{IsLocal:ot,SourceUrl:W,ConversationId:V,Context:j},User:{Name:"",UserId:H},IsTest:G,ConversationLanguage:te||"",IsHidden:!!o};i&&(l.Payload=i,r&&(l.PayloadType=r)),je.pageStartAt=new Date,X.isConnected?Zt(l,s,t,a):(console.warn("[Kenyt.AI] Connection not yet initiated, suspending message.."),Ho(l,s||null,t,a),wt())}}function Zt(a,o,i,r,s){if(l){if(s||(s=0),console.debug("Sending message to server"),console.debug("BotClientName: "+z),console.debug(a),m||a.RequestType!=De.UserMessage||(m=!0,Lt("event",ge.EVENT_FIRST_USER_REQUEST)),!ae&&a.RequestType!==De.AutoMessage){ae=!0,Fo(Be.ChatStart,{messageText:i||a.Text});var e=Do();To(e)&&(a.BrowserInformation=e)}H&&!a.User.UserId&&(a.User.UserId=H),V&&!a.Conversation.ConversationId&&(a.Conversation.ConversationId=V),a.Conversation.TimezoneOffsetMinutes=-1*(new Date).getTimezoneOffset(),a.BotUserWebContext=Fe,l.invoke("UserMessage",p,a).done(function(e){if(e)d=new Date,nn(o),a.RequestType===De.AutoMessage&&(je.isSentAck=!0),a.RequestType===De.UserMessage&&(it||G||window.setTimeout(function(){Fa(Pe.PageInfoRequest)},100),Fo(Be.UserMessage,{messageText:a.Text}));else{if(Ka("Send failed. Reconnecting..."),window.setTimeout(function(){wt()},5e3),a.RequestType===De.UserMessage)if(s<3){Ho(a,o,i,r,"",s+1),r=!0;var t=a.BotClientId+"_"+a.Text;Lt("event",ge.EVENT_MESSAGE_UNSUCCESSFUl,Za("user_interaction",null,t))}else{var n=a.BotClientId+"_"+a.Text;Lt("event",ge.EVENT_MESSAGE_ABANDONED,Za("user_interaction",null,n))}X.isConnected=!1,X.reason="UserMessageFalse"}}).fail(function(e){if(Ka("Send failed. Reconnecting..."),window.setTimeout(function(){wt()},5e3),a.RequestType===De.UserMessage)if(s<3){Ho(a,o,i,r,"",s+1),r=!0;var t=a.BotClientId+"_"+a.Text;Lt("event",ge.EVENT_MESSAGE_UNSUCCESSFUl,Za("user_interaction",null,t))}else{var n=a.BotClientId+"_"+a.Text;Lt("event",ge.EVENT_MESSAGE_ABANDONED,Za("user_interaction",null,n))}X.isConnected=!1,X.reason="UserMessageFail",an(e),console.debug("Connection lost, Suspending message.."),r=!0}),r||ee.push({id:tt++,isUserMessage:!0,message:a.Text,displayMessage:i,messageTimestamp:Va()}),ln(),ae&&Lt("event",ge.EVENT_MESSAGE_SENT,Za("messages")),ha()}else console.error("[Kenyt.AI] Cannot send message - HubProxy is null")}function Xt(e){en();var t=tn(e);rt.indicatorView=t[0],rt.senderDetailsView=t[1],M.appendChild(rt.senderDetailsView),M.appendChild(rt.indicatorView)}function en(){rt.senderDetailsView&&(rt.senderDetailsView.remove(),rt.senderDetailsView=null),rt.indicatorView&&(rt.indicatorView.remove(),rt.indicatorView=null)}function tn(e){var t=document.createElement("div"),n=oa();n.appendChild(Bo(Ie.TYPING_INDICATOR)),t.classList.add("col-12"),t.appendChild(n);var a=Bo(Ie.SENDER_DETAILS);return a.querySelector("[data-persona]").textContent=e,[t,a]}function nn(e){if(e){var t=e.querySelector(".message-timestamp");t&&t.remove()}}function an(e){console.debug("Sending message failed"),e&&(console.error(e),e.message=e.message||"",e.message="Failed Message: "+e.message,It(e))}function on(e){0<Je.length?Je.push(e):0<e.SendWithDelayMs?(Je.push(e),window.setTimeout(function(){rn()},e.SendWithDelayMs)):0<e.SendOnSilenceMs?(Je.push(e),window.setTimeout(function(){rn()},10)):dn(e)}function rn(){if(0<Je.length){var e=Je.splice(0,1)[0];0<e.SendOnSilenceMs?sn(e.SendOnSilenceMs,function(){dn(e),Ga(e.Text)}):(dn(e),Ga(e.Text)),0<Je.length&&0===Je[0].SendWithDelayMs?rn():0<Je.length&&0<Je[0].SendWithDelayMs?window.setTimeout(function(){rn()},Je[0].SendWithDelayMs):console.debug("No items in message queue")}}function sn(e,t){ln(),r=window.setTimeout(function(){t()},e)}function ln(){r&&(window.clearTimeout(r),r=0)}function dn(e){Xt("bot"===e.DisplayName?ze.name:e.DisplayName),window.setTimeout(function(){en(),console.debug(e),cn(e),c=e.DisplayName,ee.push({id:tt++,isUserMessage:!1,message:e,messageTimestamp:Va(),displayMessage:null}),ha()},ve)}function cn(e,t){if(e.IsPartial&&Et)un(e);else{if(e.DisplayName!==c&&ro(e.DisplayName,Va()),e.Command&&e.Command.Name)if(e.Command.Name===T.CONTACT_FORM.Trigger)ho((o=Wo.getFormDetailsFromCommand(e.Command)).template,e.DisplayName),go(o.template,o.setttings);else if(e.Command.Name===T.APPOINTMENT_FORM.Trigger){ho((o=Wo.getFormDetailsFromCommand(e.Command)).template,e.DisplayName),go(o.template,o.setttings)}else if(e.Command.Name===T.ADDRESS_FORM.Trigger){ho((o=Wo.getFormDetailsFromCommand(e.Command)).template,e.DisplayName),go(o.template,o.setttings)}else if(e.Command.Name===T.LATLONG_FORM.Trigger)t||bt();else if(e.Command.Name===T.FIREBASE_FORM.Trigger)t||St();else if(e.Command.Name===T.FILE_UPLOAD.Trigger){var a=vo(e.Command.Value),r=Uo();r.onSubmit=function(e){e.preventDefault();var t=e.target.getElementsByTagName("button");if(t&&t.length)for(var n=0;n<t.length;n++)qt(t[n]);var o=!0,i=[];r.fields.forEach(function(a){var t=[];t.push({inputElementRef:a.inputElementRef,feedbackElementRef:a.feedbackElementRef}),a.extraInputs&&a.extraInputs.forEach(function(e){t.push(e)}),t.forEach(function(e){var t=e.inputElementRef.value;if(a.isMandatory&&0==i.length||da(t)){var n=da(t);if(n&&"file"==a.datatype){20971520<e.inputElementRef.files[0].size&&(n=!1)}n?(console.debug("Setting User."+a.field+" = "+t),Pa(e),i.push(e.inputElementRef.files[0])):(console.debug("Form not valid"),Ba(e),o=!1)}})}),o||(i=[]),pn(i,a,e)},go(r,a),ho(r,e.DisplayName)}else if(e.Command.Name===T.CALLER.Trigger)t||Yo(e);else if(e.Command.Name===T.OTP.Trigger){if(e.Command.Value){var n=null;try{n=JSON.parse(e.Command.Value).phone}catch(e){console.error("Error parsing command value",e)}Gn(ia(On(n)))}}else if(e.Command.Name===T.GENERIC_FORM.Trigger){var o;if(e.Command.Value)ho((o=Wo.getFormDetailsFromCommand(e.Command)).template,e.DisplayName),go(o.template,o.setttings)}else if(e.Command.Name===T.NAVIGATE.Trigger){if(!t){var i={url:e.Command.Value};Fa(Pe.NavigateToPage,i)}}else if(e.Command.Name===T.SETTINGS_OVERRIDE.Trigger){jn(fo(e.Command.Value),!0)}else if(e.Command.Name===T.SET_SESSION.Trigger)t||ao(vo(e.Command.Value));else if(e.Command.Name===T.NOTIFY_LEAD_CAPTURE.Trigger){if(!t){var s=vo(e.Command.Value);Fo(Be.ContactFormSubmit,s)}}else if(e.Command.Name===T.OPEN_RAZORPAY_BUTTON.Trigger){var l=vo(e.Command.Value);l.FrameColor=Zn(),Jo.addRazorpayButton(l)}if(e.Text||0<e.RichCards.length){var d=oa(e.Text,e.RichCards,e.CardsType,e.ContentType,e.XPath||"",e.Name);e.CardsType&&e.CardsType===Re.FooterMenu&&(Qe.footerMenu.content=e),Gn(d),at&&da(e.Text)&&Oo(e.Text)}}}function un(e){e&&e.RichCards&&hn(e.RichCards,e.CardsType)}function pn(t,n,a){if(t&&0<t.length){var e=t[0];t.shift();var o=new FormData;o.append("UploadFile",e);var i=n.FailureCallback||"submit file failure",r={};r.FileName=e.name,$.ajax({url:Oe+"?botId="+z+"&userId="+H,type:"POST",data:o,success:function(e){e&&e.item2?Qt(n.SubmitCallback||e.item1,null,!1,!0,!1,e.item2,"file"):Qt(i,null,!1,!0,!1,r)},error:function(e){r.message=e,Qt(i,null,!1,!0,!1,r)},complete:function(e){pn(t,n,a)},cache:!1,contentType:!1,processData:!1})}else{var s=a.target.getElementsByTagName("button");if(s&&s.length)for(var l=0;l<s.length;l++)zt(s[l])}}function mn(e){e&&e.HeaderMenu&&fn(e.HeaderMenu)}function fn(e){if(Qe.headerMenu.container&&e&&e.RichCards){Qe.headerMenu.content=e;var o=Qe.headerMenu.container.getElementsByClassName("dropdown-menu");if(0<o.length){var i=e.RichCards,r=0;i&&i.length&&i.forEach(function(e){if(e){r++;var t=xn(e,Ie.HEADER_MENU_ITEM,r,i.length),n=t.innerText,a=t.getAttribute("message");a||(a=t.innerText),t.addEventListener("click",function(){Qt(a,n)}),o[0].appendChild(t)}});var t=xn({Title:"Restart Chat",Image:"icon:refresh"},Ie.HEADER_MENU_ITEM,r,i.length);t.setAttribute("id","k-chat-restart"),t.addEventListener("click",function(){oo()}),o[0].appendChild(t)}}}function gn(e,t){var n=document.getElementById("footer-menu");if(e&&(Ye.previousStateLoaded||Qe.footerMenu.isOpened)){var a=e.getElementsByClassName("interactive-menu-options");if(a&&0<a.length)a=a[0],Qe.footerMenu.optionsContainer.appendChild(a),a.classList.remove("d-none"),n.classList.remove("footer-hidden"),t=t||"Menu",document.getElementById("footer-menu-title").innerText=t,document.getElementById("chatWindow").classList.add("footer-menu"),n.classList.add("open"),n.classList.remove("footer-minimized"),Qe.footerMenu.isOpen=!0,Qe.footerMenu.referenceElement=e}}function vn(e,t,n,a){if(0<e.length){var o=document.createElement("div"),i=void 0;return t===Re.None||t===Re.Thumbnail?(i=e[0].Image?In(e):mo(n,"MultipleChoice")?Dn(e):mo(n,"Dropdown")?Fn(e):yn(e)).classList.add("text-center"):t===Re.SmallButton?i=En(e,Ie.SMALL_BUTTON_CARD):t===Re.MediumButton?i=En(e,Ie.MEDIUM_BUTTON_CARD):t===Re.VisitingCard?i=En(e,Ie.VISITING_CARD):t===Re.VerticalCard?i=En(e,Ie.VERTICAL_CARD):t===Re.Hero?console.debug("Card Type: Hero"):t===Re.Image||t===Re.Gif||t===Re.Video?i=In(e):t===Re.QuickLink?console.debug("Card Type: QuickLink"):t===Re.Location?i=En(e,Ie.LOCATION_CARD):t===Re.File?i=En(e,Ie.FILE_CARD):t===Re.FooterMenu?i=En(e,Ie.FOOTER_MENU,a):t===Re.InteractiveList?i=En(e,Ie.INTERACTIVE_CARD,a):(console.error("Cannot render card"),console.error("Unknown card type: "+t)),i&&(Et={container:i,size:e.length},i.classList.add("mt-1"),o.appendChild(i)),o}}function hn(e,t){Et&&0<e.length&&(t===Re.None||t===Re.Thumbnail?e[0].Image&&_n(e):t===Re.SmallButton?Tn(e,Ie.SMALL_BUTTON_CARD):t===Re.MediumButton?Tn(e,Ie.MEDIUM_BUTTON_CARD):t===Re.VisitingCard?Tn(e,Ie.VISITING_CARD):t===Re.VerticalCard?Tn(e,Ie.VERTICAL_CARD):t===Re.Hero?console.debug("Card Type: Hero"):t===Re.Image||t===Re.Gif||t===Re.Video?_n(e):t===Re.QuickLink?console.debug("Card Type: QuickLink"):t===Re.Location?Tn(e,Ie.LOCATION_CARD):t===Re.File?Tn(e,Ie.FILE_CARD):t===Re.FooterMenu?Tn(e,Ie.FOOTER_MENU):t===Re.InteractiveList?Tn(e,Ie.INTERACTIVE_CARD):(console.error("Cannot render card"),console.error("Unknown card type: "+t)))}function yn(e){var n=document.createElement("div");n.classList.add("card-thumbnail");var a=0;if(e&&e.length&&e.forEach(function(e){if(e){a++;var t=Sn(e.Title,e.Options.tap,e.IsNavigational);n.appendChild(t),10<a&&t.classList.add("extra-option")}}),10<a){n.classList.add("show-less");var t=Bo(Ie.SHOW_MORE_BUTTON);t.addEventListener("click",function(){n.classList.remove("show-less")}),n.appendChild(t)}return n}function En(e,n,t){var a=document.createElement("div"),o=0,i=10,r=Bo(n),s=r.getAttribute("data-max-cards");if(s&&(i=parseInt(s,10))<=0&&(i=10),e&&e.length){var l=Cn(e);e.forEach(function(e){if(e){var t=xn(e,n,++o,l);a.appendChild(t),i<o&&t.classList.add("extra-option")}})}var d=r.getAttribute("data-container");switch(d||(d=""),d){case"CarouselContainer":if(a.classList.add("custom-carousel"),e.length<=1){var c=JSON.parse(JSON.stringify(Ke));c.arrows=!1,c.autoplay=!1,c.dots=!1,$(a).slick(c)}else $(a).slick(Ke);$(a).slick("setPosition");break;case"FooterMenu":a.classList.add("interactive-menu-options"),a.classList.add("d-none"),Qe.footerMenu.contentElement.innerHTML="",Qe.footerMenu.contentElement.appendChild(a),Qe.footerMenu.hidden=!1,Qe.footerMenu.container.classList.remove("footer-hidden"),gn(Qe.footerMenu.contentElement,t);var u=document.createElement("div");a=u;break;case"InteractiveMenu":a.classList.add("interactive-menu-options"),a.classList.add("d-none");var p=document.createElement("div"),m={};m.Title=t||"Menu",m.Image="icon:bars",m.Options=[];var f=xn(m,Ie.SMALL_BUTTON_CARD,1,1);f.addEventListener("click",function(e){gn(p,t)}),p.appendChild(f),p.appendChild(a),a=p;break;default:if(a.classList.add("card-thumbnail"),i<o){a.classList.add("show-less");var g=Bo(Ie.SHOW_MORE_BUTTON);g.addEventListener("click",function(){a.classList.remove("show-less")}),a.appendChild(g)}}return a}function Tn(e,n){var t=Bo(n).getAttribute("data-container");switch(t||(t=""),t){case"CarouselContainer":var a=Et.size;$(Et.container).slick("slickRemove",a-1);var o=e.length+a-1,i=Cn(e);e.forEach(function(e){var t=xn(e,n,a,i);t&&($(Et.container).slick("slickAdd",t),a++)}),$(Et.container).slick("slickGoTo",Et.size-1),Et.size=o}}function Cn(e){var t=e.length;return e[e.length-1].IsNavigational&&(t=e[e.length-1].Total),t}function bn(e,t,n){var a=document.createElement("div");return e=Na(e),a.textContent=e,a.classList.add("option-pill"),t&&(a.classList.add("pointer"),a.addEventListener("click",function(){Qt(t,e,!1,n)})),a}function Sn(e,t,n){var a=bn(e,t,n),o=document.createElement("div");return o.classList.add("option-pill-container"),o.appendChild(a),o}function xn(n,e,t,a){var o=Bo(e);if(n.ElementId&&(o.id=n.ElementId),o.querySelectorAll("[data-card-title]").forEach(function(e){e&&n.Title&&(e.textContent=n.Title)}),o.querySelectorAll("[data-card-subtitle]").forEach(function(e){e&&n.SubTitle&&(e.textContent=n.SubTitle)}),n.Coordinates){var i=o.querySelector("[data-card-coordinates]");if(i||o.hasAttribute("data-card-coordinates")&&(i=o),i){var r="https://www.google.com/maps?q="+n.Coordinates.Item1+","+n.Coordinates.Item2;i.addEventListener("click",function(){window.open(r,"_blank")})}}o.querySelectorAll("[data-card-fileurl]").forEach(function(e){e&&n.FileUrl&&e.addEventListener("click",function(){window.open(n.FileUrl,"_blank")})}),o.querySelectorAll("[data-card-description]").forEach(function(e){e&&n.Description&&(e.innerHTML=n.Description)});var s=o.querySelector("[data-card-tapbutton]");s||o.hasAttribute("data-card-tapbutton")&&(s=o);var l=po(n.Image);if(l)o.querySelectorAll("[data-card-icon-container]").forEach(function(e){e&&(e.firstChild?e.insertBefore(l,e.firstChild):e.appendChild(l))});else if(n.Image){o.querySelectorAll("[data-card-image]").forEach(function(e){e&&(e.src=n.Image)})}if(s&&n.OnClick)s.addEventListener("click",function(e){n.OnClick(e)});else if(s&&n.Options){var d=Object.keys(n.Options);if(0<d.length){var c=n.Options.tap;c||(c=n.Options[d[0]]),s.addEventListener("click",function(){Qt(c,n.Title,!1,n.IsNavigational)})}}var u=o.querySelector("[data-card-add-btns]");u&&n.Options&&Object.keys(n.Options).forEach(function(e){switch(e){case"Open":break;default:var t=Bo(Ie.CARD_BUTTON);t&&(t.textContent=e,t.addEventListener("click",function(){Qt(n.Options[e],e,!1,n.IsNavigational)}),u.appendChild(t))}});var p=n.Total||a;p&&1<p&&o.querySelectorAll("[data-card-slide-number]").forEach(function(e){e&&(n.IsNavigational||(e.textContent=t+"/"+p))});return o.querySelectorAll("[data-marked-content]").forEach(function(e){e&&e.innerHTML&&(e.innerHTML=marked(e.innerHTML))}),o}function Ln(e,t){var n=document.getElementById(e);if(n){if(t.Title)n.querySelectorAll("[data-card-title]").forEach(function(e){e&&(e.textContent=t.Title)});var a=n.querySelector("[data-card-tapbutton]");a||n.hasAttribute("data-card-tapbutton")&&(a=n),t.RemoveId&&n.removeAttribute("id"),a&&t.RemoveClick&&(n.removeAttribute("class"),a.outerHTML=a.outerHTML)}}function In(e){console.log(e);var n=document.createElement("div");if(e&&0<e.length){var a=Cn(e),o=1;e.forEach(function(e){var t=Mn(e,o,a);t&&(n.appendChild(t),o++)})}if(n.classList.add("custom-carousel"),e.length<=1){var t=JSON.parse(JSON.stringify(Ke));t.arrows=!1,t.autoplay=!1,t.dots=!1,$(n).slick(t)}else $(n).slick(Ke);return $(n).slick("setPosition"),n}function Mn(t,e,n){var a=document.createElement("div"),o=wn(t);if(o||(t.Image&&da(t.Image)?(o=document.createElement("img")).src=t.Image:t.Gif&&da(t.Gif)&&((o=document.createElement("img")).src=t.Gif)),o){a=document.createElement("div");var i=document.createElement("div");i.classList.add("img-container");var r=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),d=null,c=document.createElement("div"),u=document.createElement("span");if(!t.IsNavigational){var p=t.Total||n;u.textContent=e+"/"+p}if(o.setAttribute("data-index",e),o.alt=t.Title,o.classList.add("custom-carousel-image","loading","pointer"),o.addEventListener("load",function(){o.classList.remove("loading")}),o.addEventListener("error",function(){It({message:"Media not found: "+mediaUrl},!1)}),t.Options){var m=[],f=!1;if(Object.keys(t.Options).forEach(function(e){switch(e){case"Open":a.setAttribute("data-open-imageurl",t.Options.Open),a.setAttribute("data-open-caption",t.Title),a.addEventListener("click",function(e){kn(a)}),f=!0;break;default:m.push({title:e,value:t.Options[e]})}}),0<m.length){if(!f){var g=m[0];o.addEventListener("click",function(){Qt(g.value,g.title,!1,t.IsNavigational)})}(d=document.createElement("div")).classList.add("text-center"),m.forEach(function(e){return d.appendChild(bn(e.title,e.value,t.IsNavigational))})}}r.textContent=t.Title,s.textContent=t.SubTitle,l.textContent=t.Description,a.classList.add("card-border"),r.classList.add("text-center"),r.classList.add("data-title"),s.classList.add("text-center"),s.classList.add("data-subtitle"),l.classList.add("text-center"),u.classList.add("text-center"),c.classList.add("text-center","card-index","primary-border"),c.appendChild(u),c.style.height=c.style.width,r.textContent&&a.appendChild(Oa([],r)),i.appendChild(o),a.appendChild(i),1<n&&i.appendChild(c),s.textContent&&a.appendChild(Oa([],s)),l.textContent&&a.appendChild(Oa([],l)),d&&a.appendChild(Oa([],d))}return a}function wn(t){if(t&&da(t.Video))try{var e=new URL(t.Video).searchParams.get("v");if(e)return An(e);var n=document.createElement("video");n.setAttribute("controls","");var a=document.createElement("source");return a.src=t.Video,n.appendChild(a),n}catch(e){console.error("[Kenyt.AI] Error rendering Youtube Video: "+t.Video),console.error(e)}return null}function An(e){var t=document.createElement("iframe");return t.src="https://www.youtube-nocookie.com/embed/"+e,t.frameBorder=0,t.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen="allowFullscreen",t}function kn(e){var t=Nn(e);if(0<=t){for(var n=[],a=e.previousElementSibling;a;){var o=Nn(a);if(0<=o&&o<t){if(c=a.getAttribute("data-open-imageurl")){var i={imageUrl:c,caption:a.getAttribute("data-open-caption")};n.push(i)}a=a.previousElementSibling}else a=null}for(var r=[],s=e,l=t;s;){var d=Nn(s);if(0<=d&&l<=d){var c;if(l=d,c=s.getAttribute("data-open-imageurl")){var u={imageUrl:c,caption:s.getAttribute("data-open-caption")};r.push(u)}s=s.nextElementSibling}else s=null}var p={};for(p.currentSlideNumber=n.length+1,p.slides=[];n.length;){var m=n.pop();p.slides.push(m)}for(var f=0;f<r.length;f++)p.slides.push(r[f]);Fa(Pe.FullScreenImage,p)}}function Nn(e){var t=-1,n=e.getElementsByClassName("custom-carousel-image");return n&&(n=n[0])&&(t=n.getAttribute("data-index")),t}function _n(e){if(Et&&e&&0<e.length){var n=Et.size;$(Et.container).slick("slickRemove",n-1);var t=e.length+n-1,a=Cn(e);e.forEach(function(e){var t=Mn(e,n,a);t&&($(Et.container).slick("slickAdd",t),n++)}),$(Et.container).slick("slickGoTo",Et.size-1),Et.size=t}}function On(e){var n=Bo(Ie.OTP_FORM),a=n.querySelector("[data-input-field]"),o=n.querySelector("[data-submit]").querySelector("span"),t=n.querySelector("[data-mobile-number]"),i=n.querySelector("[data-error-description]"),r=n.querySelector("[data-change-mobile-number]"),s=n.querySelector("form");return t.textContent=e||"your mobile",a.pattern=fe.source,a.addEventListener("change",function(){i.textContent=""}),r.addEventListener("click",function(){var e=n.parentElement,t=ia(Rn());n.remove(),e.appendChild(t)}),s.addEventListener("submit",function(e){e.preventDefault();var t=a.value;i.textContent="",o.classList.remove("fa-paper-plane"),o.classList.add("fa-spin","fa-spinner"),fe.test(t)?(console.log("OTP Validated"),Qt(t,t,!1,!1,!1),n.remove()):(console.warn("OTP Invalid"),i.textContent="The OTP you entered is invalid, try again")}),n}function Rn(){var t=Bo(Ie.PHONE_NUMBER_FORM),n=t.querySelector("[data-input-field]"),a=t.querySelector("[data-error-description]"),e=t.querySelector("form");return window.intlTelInput(n,{geoIpLookup:function(e){e("IN")},hiddenInput:"full_number",initialCountry:"auto",placeholderNumberType:"MOBILE",separateDialCode:!0,utilsScript:le}),n.addEventListener("change",function(){a.textContent=""}),e.addEventListener("submit",function(e){e.preventDefault(),a.textContent="",n.value?(Qt(""+re+n.value,n.value,!1,!1,!1),t.remove()):a.textContent="Please enter a valid mobile number"}),t}function Dn(e){var t=document.createElement("div");t.classList.add("multiplechoices");var a=document.createElement("div");t.appendChild(a);var o=document.createElement("button");o.textContent=Na("None of the above")+" ",o.classList.add("btn","btn-success","submit","mt-2");var n=document.createElement("span");return n.classList.add("fa","fa-send"),o.appendChild(n),o.addEventListener("click",function(){Un(a)}),t.appendChild(o),e&&e.length&&e.forEach(function(e){if(e){var t=document.createElement("div");t.textContent=e.Title,t.classList.add("option-pill"),e.Options.tap&&(t.setAttribute("content",e.Options.tap),t.classList.add("pointer"),t.addEventListener("click",function(){t.classList.toggle("isSelected"),Bn(o,a)}));var n=document.createElement("div");n.classList.add("option-pill-container"),n.appendChild(t),a.appendChild(n)}}),t}function Pn(e){var t=[],n=[];if(e&&e.children)for(var a=e.children,o=0;o<a.length;o++){var i=a[o].children[0];i.classList.contains("isSelected")&&(t.push(i.getAttribute("content")),n.push(i.textContent))}var r={};return r.selected=t.join(),r.display=n.join(),r}function Bn(e,t){var n=Pn(t);e&&n&&(n.selected?e.textContent=Na("Submit")+" ":e.textContent=Na("None of the above")+" ")}function Un(e){var t=Pn(e);t.selected?Qt(t.selected,t.display):Qt("None of the above",Na("None of the above"))}function Fn(e){var t=document.createElement("div");t.classList.add("dropdown");var n=[];e&&e.length&&e.forEach(function(e){if(e&&e.Options.tap){var t=e.Title+":"+e.Options.tap;n.push(t)}});var a=Aa(n,"");t.appendChild(a),a=Hn(a);var o=document.createElement("button");o.textContent=Na("Submit")+" ",o.classList.add("btn","btn-success","submit","mt-2");var i=document.createElement("span");return i.classList.add("fa","fa-send"),o.appendChild(i),o.addEventListener("click",function(){Vn(a)}),t.appendChild(o),t}function Hn(e){var t=e.parentNode,n=document.createElement("div");n.classList.add("dropdown-search"),t.insertBefore(n,e);var a=document.createElement("input");a.classList.add("primary-border"),a.classList.add("pointer"),n.appendChild(a);var o=document.createElement("div");o.classList.add("options"),o.classList.add("smooth-scroll"),o.classList.add("thin-scroll"),o.classList.add("empty-input"),o.classList.add("primary-border"),n.appendChild(o),e.childNodes.forEach(function(e){var t=document.createElement("div");t.classList.add("no-match"),t.setAttribute("data-value",e.value),t.classList.add("primary-hover"),t.classList.add("pointer"),t.innerText=e.innerText,e.value?(o.appendChild(t),t.addEventListener("click",function(e){!function(e){var t=e.target,n=t.parentNode,a=n.previousSibling;a.value=t.innerText;var o=t.getAttribute("data-value");a.setAttribute("data-value",o),t.parentNode.classList.add("empty-input");var i=n.nextSibling;i.classList.add("fa-caret-down"),i.classList.remove("fa-caret-up"),e.stopPropagation(),Ot(),qa(I)}(e)})):a.placeholder=e.innerText}),a.addEventListener("keyup",function(e){s(e.target)}),a.addEventListener("keydown",function(e){s(e.target)}),a.addEventListener("focus",function(e){s(e.target)});var i=document.createElement("span");i.classList.add("fa"),i.classList.add("fa-caret-down"),i.classList.add("icon"),i.classList.add("pointer"),n.appendChild(i),i.addEventListener("focus",function(e){s(e.target.previousSibling.previousSibling)});var r=document.createElement("span");function s(e){e.removeAttribute("data-value");var t=e.nextSibling,n=t.nextSibling.nextSibling;if(e.value){t.classList.remove("empty-input"),n.classList.remove("d-none");for(var a=!1,o=t.getElementsByTagName("div"),i=0;i<o.length;i++)o[i].innerText.toLowerCase().includes(e.value.toLowerCase())?(o[i].classList.remove("no-match"),a=!0):o[i].classList.add("no-match");a||t.classList.add("empty-input")}else{t.classList.remove("empty-input"),n.classList.add("d-none");for(o=t.getElementsByTagName("div"),i=0;i<o.length;i++)o[i].classList.remove("no-match")}var r=t.nextSibling;r.classList.remove("fa-caret-down"),r.classList.add("fa-caret-up"),qa(I)}return r.innerText="close",r.classList.add("material-icons-outlined"),r.classList.add("remove-icon"),r.classList.add("pointer"),r.classList.add("d-none"),r.addEventListener("click",function(e){var t=e.target.previousSibling.previousSibling.previousSibling;t.value="",t.focus(),s(t)}),n.appendChild(r),t.removeChild(e),a}function Vn(e){var t=e.value,n="";if(e.options&&e.selectedIndex)n=e.options[e.selectedIndex].text;else if(e.list&&e.list.options)for(var a=0;a<e.list.options.length;a++)e.list.options[a].value==t&&(n=e.list.options[a].innerText);else e.hasAttribute("data-value")&&(t=e.getAttribute("data-value"),n=e.value);t&&(n||(n=t),Qt(t,n))}function zn(e){e.which===g||e.keyCode===g?e.target.value&&(e.preventDefault(),qn()):Xo(e.target)}function qn(){var e=w.value;e&&(at=!1,Qt(e,e),w.value=""),Xo(w)}function Gn(e){if(M){var t=document.createElement("div");t.classList.add("col-12"),He?He=!1:t.classList.add("mt-2");for(var n=arguments.length,a=Array(1<n?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];a.forEach(function(e){t.classList.add(e)}),t.appendChild(e),Wn(t),M.appendChild(t),window.setTimeout(function(){qa(I)},100)}}function Wn(e){Ko.setFittingClassByText(e)}function jn(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];console.debug("Applying the following window configuration"),console.debug(e);var a=[],o=Qa(),i="py-1";if(e){if(da(e.FontFamily)&&a.push({elementSelector:"#chatWindow",properties:[{property:"font-family",value:"'"+e.FontFamily+"'"}]}),da(e.BotPosition)&&Fa(Pe.UpdateBotPosition,e.BotPosition),da(e.FrameColor)){var r=$o.getThemeSettings(e.FrameColor,e.FrameColorGradient);if(r){var s=$o.getThemeSettings("#ffffff","#ffffff");r.backgroundColor?b.style.backgroundColor=r.backgroundColor:b.style.backgroundImage=r.backgroundGradient,b.style.color=r.textColor,k.style.color=r.textColor,O.style.color=r.textColor,w.style.borderColor=r.color,O.style.backgroundColor=r.color,k.style.backgroundColor=r.color,Fa(Pe.UpdateChatBubbleColor,r.color),Fa(Pe.TextColor,r.textColor),a.push(),a.push({elementSelector:".option-pill:hover",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.buttonBackgroundColorHover,override:!0},{property:"background-color",value:""+r.buttonBackgroundColorHover,override:!0}]},{elementSelector:".option-pill.isSelected",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.buttonBackgroundColorHover,override:!0},{property:"background-color",value:""+r.buttonBackgroundColorHover,override:!0}]},{elementSelector:".option-pill",properties:[{property:"color",value:""+r.buttonColor,override:!0},{property:"border-color",value:""+r.buttonBorderColor,override:!0},{property:"background-color",value:""+r.buttonBackgroundColor,override:!0}]},{elementSelector:".bg-accent",properties:[{property:"background-image",value:""+r.backgroundGradient,override:!0}]},{elementSelector:".text-accent",properties:[{property:"color",value:""+s.textColor,override:!0}]},{elementSelector:".bot-chat-bubble",properties:[{property:"color",value:s.textColor+" !important"}]},{elementSelector:".interactivelist-card:hover",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.colorTo,override:!0},{property:"background-color",value:""+r.colorTo,override:!0}]},{elementSelector:".primary-border",properties:[{property:"border-color",value:r.color+" !important"}]},{elementSelector:".primary-background",properties:[{property:"background-color",value:r.color+" !important"}]},{elementSelector:".primary-color",properties:[{property:"color",value:r.color+" !important"}]},{elementSelector:".primary-text",properties:[{property:"color",value:r.textColor+" !important"}]},{elementSelector:".primary-hover:hover",properties:[{property:"color",value:""+r.buttonColorHover,override:!0},{property:"border-color",value:""+r.buttonBackgroundColorHover,override:!0},{property:"background-color",value:""+r.buttonBackgroundColorHover,override:!0}]})}}if(da(e.EnableSpeech)&&window.hasOwnProperty("webkitSpeechRecognition")&&(mo(e.EnableSpeech,"true")?Da(N):Ra(N)),da(e.UserPersona)&&(t&&(e.UserPersona=$n(e.UserPersona)),uo("user",e.UserPersona,t)),da(e.BotPersona)&&(t&&(e.BotPersona=$n(e.BotPersona)),uo("bot",e.BotPersona,t)),da(e.FontSize)&&(M.style.fontSize=""+e.FontSize),da(e.HeaderTextColor)&&(x.style.color=e.HeaderTextColor,L.style.color=e.HeaderTextColor),da(e.HeaderTitle)&&(e.HeaderTitle===de?(x.innerHTML="&nbsp;",b.classList.contains(i)||b.classList.add(i)):x.textContent=e.HeaderTitle),da(e.HeaderSubTitle)&&(e.HeaderSubTitle===de?L.innerHTML="&nbsp;":(L.textContent=e.HeaderSubTitle,b&&e.HeaderTitle!==de&&b.classList.contains(i)&&b.classList.remove(i))),da(e.HeaderFontSize)&&(x.style.fontSize=e.HeaderFontSize),!t&&(mo(e.ShowPoweredBy,"true")?D.classList.remove("d-none"):D.classList.add("d-none"),e.PoweredBy&&e.PoweredBy.Name&&e.PoweredBy.Website)){var l=document.getElementById("brand-link");l&&(D.classList.remove("d-none"),l.setAttribute("href",e.PoweredBy.Website),l.innerText=e.PoweredBy.Name)}if(da(e.PlaceholderText)&&Yn(e.PlaceholderText),da(e.BackgroundImage)&&Xn(e.BackgroundImage),da(e.BackgroundColor)&&ea(e.BackgroundColor),da(e.UserChatBubbleColor)){var d=$o.getThemeSettings(e.UserChatBubbleColor,e.UserChatBubbleColorGradient);d&&a.push({elementSelector:".user-chat-bubble",properties:[{property:"background-color",value:d.color+" !important"},{property:"color",value:d.textColor+" !important"}]})}if(da(e.AvatarImage)&&(S.src=e.AvatarImage),da(e.LiveAgentCall)&&mo(e.LiveAgentCall,"true")&&mo(e.HideMenuInHeader,"false")&&Da(Qe.headerMenu.container),et&&(e.DesktopMinimizeBotAtStart=e.DesktopMinimizeBotAtStart||"",e.MobileMinimizeBotAtStart=e.MobileMinimizeBotAtStart||"",e.OpenWindowAfterMilliSeconds||(e.OpenWindowAfterMilliSeconds=0),n||(o?((""==e.MobileMinimizeBotAtStart||mo(e.MobileMinimizeBotAtStart,"false")||0<e.OpenWindowAfterMilliSeconds)&&setTimeout(function(){na()},e.OpenWindowAfterMilliSeconds),io()):(""==e.DesktopMinimizeBotAtStart||mo(e.DesktopMinimizeBotAtStart,"false")||0<e.OpenWindowAfterMilliSeconds)&&setTimeout(function(){na()},e.OpenWindowAfterMilliSeconds))),0<a.length&&Wa(a),da(e.Languages)){var c=e.Languages.trim().split(",");if(c&&0<c.length){var u=to(c);u&&1<=u.length&&(u[0].value,u.forEach(function(e){e.value===te&&e.value})),no(u)}}if(e.CustomPanelCss){var p=document.createElement("style");p.innerText=e.CustomPanelCss,document.head.appendChild(p)}var m=document.getElementById("k-chat-restart");m&&(e.EnableChatRestart?m.classList.remove("d-none"):m.classList.add("d-none")),e.IdleTimeSeconds&&(Tt.idleTimeSec=e.IdleTimeSeconds,Tt.disconnectOnIdleId&&window.clearInterval(Tt.disconnectOnIdleId),Tt.disconnectOnIdleId=window.setInterval(_t,1e3*Tt.idleTimeSec))}}function $n(e){var t=e;if(da(e)){var n=e.match(me);if(n&&0<n.length){var a=n[0],o=a.match(pe);o&&0<o.length&&(t=e.replace(a,o[0]))}}return t}function Kn(e){var t=$o.normalizeColor(e);return t&&$o.getPercievedBrightness(t)>=$o.BRIGHTNESS_THRESHOLD?"#000000ff":e}function Jn(e){e&&x&&(x.textContent=e)}function Yn(e){e&&w&&(w.placeholder=e)}function Qn(){return F&&F.AvatarImage&&"string"==typeof F.AvatarImage?F.AvatarImage:defaultWindowConfig.AvatarImage}function Zn(){return da(F.FrameColor)?F.FrameColor:$e.FrameColor}function Xn(e){e&&I&&(I.style.backgroundImage="url("+e+")")}function ea(e){da(e)&&(I.style.backgroundColor=e)}function ta(){Fa(Pe.ChatWindowClose)}function na(){Fa(Pe.ChatWindowOpen)}function aa(e,t,n){var a=document.createElement("div"),o=document.createElement("p");return a.classList.add("d-inline-block","px-2","py-2","float-right","user-chat-bubble"),o.textContent=e,a.appendChild(o),n||a.appendChild(za(t)),a}function oa(e,t,n,a,o,i){e||(e="");var r=document.createElement("div");if(r.classList.add("d-inline-block","px-2","py-2","bot-chat-bubble"),r.innerHTML=marked(e),ra(r),t&&0<t.length){var s=vn(t,n,a,i);s&&r.appendChild(s),n&&(n!==Re.MediumButton&&n!==Re.VerticalCard||r.classList.add("chat-bubble-fullwidth"),n===Re.File&&r.classList.add("min-width-50"),n===Re.Location&&(r.classList.add("min-width-50"),r.classList.add("chat-bubble-flexible-width")))}if(o){var l=G;if(!l){var d=(ba()?be.LOCAL:be.PROD)+"/create/bot";W&&W.startsWith(d)&&(l=!0)}if(l&&p){var c=document.createElement("div");c.classList.add("pointer","intent-edit");var u=(ba()?be.LOCAL:be.PROD)+"/settings/training?orgid="+p.OrganizationId+"&botid="+p.BotId+"&xpath="+o;c.innerHTML='<span class="fa fa-pencil intent-edit-icon"></span>',c.addEventListener("click",function(){var e={url:u,openInSamePage:!1};Fa(Pe.NavigateToPage,e)}),r.appendChild(c)}}return r}function ia(e){return e&&e.classList.add("d-inline-block","px-2","py-2","bot-chat-bubble"),e}function ra(e){if(e){var t=Array.from(e.querySelectorAll("a"));t&&0<t.length&&t.forEach(function(e){e.target||(e.target="_blank")})}}function sa(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function la(e){return e&&"string"==typeof e}function da(e){return la(e)&&0<e.trim().length}function ca(){return{botName:z,lastConversationId:V,conversationLanguage:te,timestamp:new Date,botUserWebContext:Fe,messages:G?[]:ee}}function ua(){return{conversationId:V,isMinimized:qe,menu:Qe.headerMenu.content,userPersona:Ve,botName:z,expandType:B&&B.getAttribute("data-toggle")||null,timestamp:new Date,pageUrl:W,queryUserDenied:u}}function pa(){if(ne){var e=window.localStorage.getItem(h);e?(H=e,console.debug("UserId restored from local storage")):console.debug("UserId not found in local storage")}}function ma(e){e&&(e.timestamp&&(e.timestamp=new Date(e.timestamp)),e.lastConversationId&&e.lastConversationId!==V&&(so(e.timestamp,new Date)<Le?(V=e.lastConversationId,Fa(Pe.Initialize,V),e.messages&&0<e.messages.length&&(va(e.messages),window.setTimeout(function(){qa(I)},0))):(ee=[],console.debug("Session timed out, using new conversationID"),Fe.SessionCount?Fe.SessionCount=Fe.SessionCount+1:Fe.SessionCount=1)),e.conversationLanguage&&(te=e.conversationLanguage))}function fa(e){if(e&&e.botName&&e.botName===z){if(e.conversationId&&(V=e.conversationId),e.userPersona&&uo("user",e.userPersona),e.expandType)B.getAttribute("data-toggle")!==e.expandType&&io();e.isMinimized||!1===qe||na(),fn(e.menu)}}function va(e){e.forEach(function(e){if(e.message)if(e.isUserMessage)"user"!==c&&ro("user",e.messageTimestamp,!0),Gn(aa(e.displayMessage?e.displayMessage:e.message,e.messageTimestamp,!0)),c="user";else{if(c!==e.message.DisplayName&&ro(e.DisplayName,e.messageTimestamp),e.customMessage&&e.customMessage.messageType===Ue.Form&&bo(e.customMessage.values)){var t=Lo(e.customMessage.values);t.fields.forEach(function(e){e&&da(e.validationPattern)&&(e.validationPattern=new RegExp(e.validationPattern))}),c!==e.customMessage.displayName&&ro(e.customMessage.displayName,e.messageTimestamp),go(t)}(To(e.message)||da(e.message))&&cn(e.message,!0),c=e.message.DisplayName}}),0<(ee=e||[]).length&&!isNaN(ee[ee.length-1].id)&&(tt=ee[ee.length-1].id+1||tt)}function ha(){if(ne){window.localStorage.setItem(h,H||"");var e=ca();console.debug("State saved in localStorage"),console.debug(e),window.localStorage.setItem(Y,JSON.stringify(e)),ya()}else console.warn("[Kenyt.AI] Unable to store state, Cookies are disabled")}function ya(){var e=ua();console.debug("State saved in sessionStorage"),console.debug(e),window.sessionStorage.setItem(J,JSON.stringify(e))}function Ea(){if(ne){var e=window.localStorage.getItem(Y);return e?JSON.parse(e):e}return null}function Ta(){if(ne){var e=window.sessionStorage.getItem(J);return e?JSON.parse(e):e}return null}function Ca(){var e=xt("origin")||document.referrer;return e||console.warn("Cannot retrieve parent URL"),e}function ba(){var e=window.location.href;return 0<=e.indexOf("http://localhost")||e.startsWith("file:///")}function Sa(){return 0<=window.location.href.indexOf("ngrok.io")}function xa(){if(ba())return console.debug("AppName set as "+Te),Te;if(Sa()){var e="https://"+window.location.hostname+Ee;return console.debug("Endpoint set as ngrok url "+e),e}return console.debug("Endpoint set as "+Ce),Ce}function La(e){return e&&"object"===(void 0===e?"undefined":a(e))&&e instanceof Date}function Ia(e){e||(console.debug=function(){})}function Ma(n,r,t,e){var a=n.tag||"div",s=document.createElement(a);s.classList.add("form");var o=document.createElement("span"),i=document.createElement("p");if(o.classList.add("h6","font-weight-bold"),i.classList.add("m-0"),o.textContent=r.Title||n.title,i.textContent=r.Description||n.description,s.appendChild(ka(["mt-1"],_a(["text-center"],o,i))),r.Slots){var l=r["Appointment Date"];l||(l={}),l.datetimepickersettings||(l.datetimepickersettings={}),l.datetimepickersettings.beforeShowDay=function(e){var t=jo.getDateKeys(e),n=!1;return t.every(function(e){return!r.Slots[e]||(n=0<r.Slots[e].length,!1)}),[n,""]},r["Appointment Date"]=l;var d=r["Appointment Time"];d||(d={}),d.datatype="dropdown",d.need="Appointment Date",d.beforeShow=function(e){var n=this,t=jo.getDateKeys(e),a=d.value;t.every(function(e){return!r.Slots[e]||(a=r.Slots[e],!1)}),a||(a="10 AM, 11 AM, 12 PM, 1 PM, 2 PM, 3 PM, 4 PM, 5 PM, 6 PM, 7 PM, 8 PM"),this.inputElementRef.innerHTML="",a.forEach||(a=a.split(",")),a.forEach(function(e){var t=document.createElement("option");t.innerText=e,t.value=e,n.inputElementRef.appendChild(t)})},r["Appointment Time"]=d}var c=void 0;n.fields.forEach(function(a){var e=wa(a,r),o=e.colEle;if(o){if(a.inputElementRef=e.inputElementRef,a.inputContainer=e.inputContainer,a.feedbackElementRef=e.feedbackElementRef,a.takeHalfRow&&o.classList.add("col-6"),c)c.appendChild(o),s.appendChild(c),c=null;else{var t=ka(["mt-2"],o);s.appendChild(t),a.takeHalfRow&&(c=t)}if(a.need&&n.fields.forEach(function(e){if(a.need===e.field&&e&&e.inputElementRef){if("datetime"===e.datatype){var t=e.datetimepickersettings.onChangeDateTime;e.datetimepickersettings.onChangeDateTime=function(e){t&&t(e),a.beforeShow&&a.beforeShow(e),Da(a.inputContainer)}}else e.inputElementRef.addEventListener("change",function(){Da(a.inputContainer)},!1);Ra(a.inputContainer)}}),a.addMore){a.extraInputs=a.extraInputs||[];var i=document.createElement("button");i.textContent=" + ",i.classList.add("btn","btn-success","add-more-btn"),i.addEventListener("click",function(e){e.preventDefault();var t=wa(a,r),n=ka(["mt-2"],t.colEle);o.parentNode.parentNode.insertBefore(n,o.parentNode.nextSibling),a.extraInputs.push({inputElementRef:t.inputElementRef,feedbackElementRef:t.feedbackElementRef}),4==a.extraInputs.length&&Ra(i)}),o.appendChild(i)}}});var u=document.createElement("button");u.textContent="Cancel",u.classList.add("btn","btn-secondary"),e&&u.addEventListener("click",function(){e()});var p=document.createElement("button");p.textContent=" "+Na("Submit")+" ",p.classList.add("btn","btn-success"),e||p.classList.add("mr-2");var m=document.createElement("span");return m.classList.add("fa","fa-send"),p.appendChild(m),n.onSubmit?s.onsubmit=n.onSubmit:t&&p.addEventListener("click",function(e){t(e,n.fields,n.submit,n.submitType)}),e?s.appendChild(ka(["mt-4"],_a(["text-center"],p,u))):s.appendChild(ka(["mt-4"],_a(["text-center"],p))),s}function wa(t,n,e){if(n[t.field]){if(n[t.field].value&&(t.value=n[t.field].value),n[t.field].isMandatory&&(t.isMandatory=n[t.field].isMandatory),n[t.field].need&&(t.isMandatory=n[t.field].need),n[t.field].beforeShow&&(t.beforeShow=n[t.field].beforeShow),n[t.field].telSettings)if(t.telSettings)Object.keys(n[t.field].telSettings).forEach(function(e){t.telSettings[e]=n[t.field].telSettings[e]});else t.telSettings=n[t.field].telSettings;if(n[t.field].datetimepickersettings)if(t.datetimepickersettings)Object.keys(n[t.field].datetimepickersettings).forEach(function(e){t.datetimepickersettings[e]=n[t.field].datetimepickersettings[e]});else t.datetimepickersettings=n[t.field].datetimepickersettings;n[t.field].errorMessage&&(t.errorMessage=n[t.field].errorMessage),n[t.field].validationPattern&&(t.validationPattern=n[t.field].validationPattern),n[t.field].image&&(t.image=n[t.field].image),n[t.field].imageClass&&(t.imageClass=n[t.field].imageClass)}var a=document.createElement("label"),o=document.createElement("input"),i=document.createElement("div");if(t.dataType&&(t.datatype=t.dataType),"dropdown"===t.datatype){t.options=t.options||t.value;var r=t.displayName||t.field;(o=Aa(t.options,r)).name=t.field}else o.type=t.datatype,t.placeholder?a.innerHTML=t.placeholder:a.textContent=t.displayName||t.field,o.placeholder=t.placeholder||t.displayName||t.field,o.placeholder=Na(o.placeholder),t.value&&(o.value=t.value);t.name&&(o.name=t.name),o.classList.add("form-control"),o.style.fontStyle="inherit",t.readonly&&o.setAttribute("readonly","readonly"),t.min&&(o.min=t.min),t.max&&(o.max=t.max),i.classList.add("invalid-feedback","d-none"),i.textContent=t.errorMessage;var s=void 0,l=void 0;if(t.image){var d=po(t.image);if(d){var c="icon-container";t.imageClass&&(c=c+","+t.imageClass),l=Oa(["input-container"],Oa(c=c.split(","),d),o)}}if(l||(l=Oa([],o)),"checkbox"===t.datatype?(o.name=t.field,o.classList.remove("form-control"),(s=_a([],l,a,i)).classList.add("checkbox"),i.style.display="block"):s=t.useLabel?_a([],a,l,i):_a([],l,i),n&&n.Mandatory&&n.Mandatory.includes(t.field)&&(t.isMandatory=!0),"tel"===t.datatype&&t.validationSource===se){var u="IN";n&&n.CountryCode&&(u=n.CountryCode);var p={geoIpLookup:function(e){e(u)},hiddenInput:"full_number",initialCountry:"auto",placeholderNumberType:"MOBILE",preferredCountries:["in","us"],separateDialCode:!0,utilsScript:le};if(t.telSettings)Object.keys(t.telSettings).forEach(function(e){p[e]=t.telSettings[e]});o.value||(o.setAttribute("type","number"),o.setAttribute("onkeydown","javascript: return event.keyCode == 69 ? false : true"));var m=window.intlTelInput(o,p);o.style.paddingLeft="85px",i.style.display="block",t.pluginObj=m}return{colEle:s,inputElementRef:o,inputContainer:l,feedbackElementRef:i}}function Aa(e,t){var a=document.createElement("select");if(e){e.forEach||(e=e.split(","));var n=document.createElement("option");n.innerText=t||"Please select",n.value="",a.appendChild(n),e.forEach(function(e){var t=document.createElement("option"),n=e.split(":");t.value=1<n.length?n[1]:n[0],t.innerText=n[0],a.appendChild(t)})}return a}function ka(e){e.push("row");for(var t=arguments.length,n=Array(1<t?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return Oa.apply(void 0,[e].concat(n))}function Na(e){var t=e;return e&&dt&&dt[e]&&(t=dt[e]),t}function _a(e){e.push("col");for(var t=arguments.length,n=Array(1<t?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return Oa.apply(void 0,[e].concat(n))}function Oa(e){var t=document.createElement("div");e.forEach(function(e){return t.classList.add(e)});for(var n=arguments.length,a=Array(1<n?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return a.forEach(function(e){return t.appendChild(e)}),t}function Ra(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){e&&!e.classList.contains("d-none")&&e.classList.add("d-none")})}function Da(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){e&&e.classList.contains("d-none")&&e.classList.remove("d-none")})}function Pa(e){var t=e.inputElementRef;t&&(t.classList.contains("is-invalid")?co(t,"is-invalid","is-valid"):t.classList.add("is-valid")),Ra(e.feedbackElementRef)}function Ba(e){var t=e.inputElementRef;t&&(t.classList.contains("is-valid")?co(t,"is-valid","is-invalid"):t.classList.add("is-invalid")),Da(e.feedbackElementRef)}function Ua(t){var n=[];return t&&"object"===(void 0===t?"undefined":a(t))&&Object.keys(t).forEach(function(e){n.push(e+"::"+t[e])}),n.join(", ")}function Fa(e,t){var n={type:e,value:t||null};window.parent.postMessage(n,"*")}function Ha(e,t){var n={type:e,value:t||null};window.parent.postMessage(n,"*");var a=document.querySelector("#kenytInWindow").contentWindow;if(a){var o={type:Pe,value:value};a.postMessage(o,"*")}}function Va(){var e=new Date,t=e.getHours()%12;return 0===t&&(t=12),t+":"+("0"+e.getMinutes()).slice(-2)+" "+(12<=e.getHours()?"PM":"AM")}function za(e){var t=document.createElement("span");return t.classList.add("float-right","text-muted","message-timestamp"),t.innerHTML=e||Va(),t}function qa(e){e&&(e.scrollTop=e.scrollHeight)}function Ga(e){qe&&(e&&(e=marked(e)),Fa(Pe.UnreadMessage,e))}function Wa(e){if(e&&0<e.length){var n="";e.forEach(function(e){var t="";e.properties&&(e.properties.forEach(function(e){t+=e.property+":"+e.value+" "+(e.override?"!important":"")+";"}),n+=e.elementSelector+"{"+t+"}")}),$("<style>"+n+"</style>").appendTo("head")}}function ja(){Ze&&0<Ze.length&&(console.debug("Found "+Ze.length+" suspended messages, sending to server now..."),Ze.forEach(function(e){e.invokeType?l.invoke(e.invokeType,e.botRequest):Zt(e.botRequest,e.viewRef,e.displayText,e.skipHistory,e.count)}),Ze=[])}function $a(){var e="__feature_test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function Ka(e,t){var n=document.querySelector("#errorbar");if(n){e=e||"Lost connection due to inactivy. ",t||(e+=' <span class="fa fa-spin fa-spinner fa-pulse"></span>'),n.innerHTML=e;var a=new Date;if(je&&je.pageStartAt)10<(a.valueOf()-je.pageStartAt.valueOf())/1e3?Da(n):console.log(e)}}function Ja(){var e=document.querySelector("#errorbar");e&&(Ra(e),e.innerHTML="")}function Ya(e){if(e&&!it){for(var t=0;t<e.length;t++)e[t].UserId=H,t===e.length-1&&(e[t].EndTime=new Date);l.invoke("TrackingUpdate",H,z,e).done(function(e){e||It({message:"Tracking update returned false"},!1)}).fail(function(e){It({message:"Tracking update failed: "+e},!1)}),it=!0}}function Qa(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function Za(e,t,n){return{event_category:e||null,event_label:t||null,value:n||null}}function Xa(e,t){da(e)&&(console.debug("Conversation language changed to "+e),te=e,Z&&(Z.lang=e),0<ee.length&&(t||Qt("start conversation",null,!1,!0)),Lt("event","language_change",Za("user_interaction",null,e)),O&&(O.textContent=e.substr(0,2).toUpperCase()))}function eo(e,t){t||(t=!1);var n={UserId:H,ConversationId:V,BotId:p?p.BotId:0,LanguageCode:e,PreventHiMessage:t};X.isConnected?l.invoke("ChangeChatLanguage",n):(console.warn("[Kenyt.AI] Connection not yet initiated, suspending message.."),Ho(n,null,!1,!0,"ChangeChatLanguage"),wt())}function to(e){var n=[];return e&&0<e.length&&e.forEach(function(t){if(da(t)){var e=we.find(function(e){return e.value===t.trim().toLowerCase()||e.value===t.trim()});e?n.push(e):console.warn("ignoring Unknown language code: "+t)}}),n}function no(e){var a=document.querySelector("#languageMenu");if(e&&a){for(;a.hasChildNodes();)a.removeChild(a.firstChild);if(e.length<=1)Ra(O);else{Da(O);var t=document.createElement("h6");t.classList.add("dropdown-header"),t.textContent="Choose language",a.appendChild(t),e.forEach(function(t){var n=document.createElement("button");n.textContent=t.displayText?t.displayText:t.text,n.addEventListener("click",function(){eo(t.value);var e=Array.from(a.querySelectorAll(".dropdown-item.active"));e&&0<e.length&&e.forEach(function(e){return e.classList.remove("active")}),n.classList.add("active")}),n.classList.add("dropdown-item"),a.appendChild(n)})}}}function ao(e){e.setNewUser&&(console.debug("resetting UserId"),H="",console.debug("resetting ConversationId"),V="",ha(),Qt("start conversation",null,!1))}function oo(){var e=_e+"?botId="+z,t=new XMLHttpRequest;t.open("POST",e,!0),t.setRequestHeader("Content-type","application/json");var n={IsTest:G,SessionUserId:H,QueryClientUserId:q,ConversationId:"",ConversationLanguage:te||"",TimezoneOffsetMinutes:-1*(new Date).getTimezoneOffset(),SourceUrl:W,TriggerAutoMessage:!0,ConversationContext:j},a=JSON.stringify(n);t.onload=function(e){Eo(),Ct(e)},t.send(a)}function io(){var e=B.getAttribute("data-toggle"),t=B.querySelector("span");Fa(Pe.ToggleFullScreen,e),"maximize"===e?(B.setAttribute("data-toggle","minimize"),t&&co(t,"fa-window-maximize","fa-window-minimize")):(B.setAttribute("data-toggle","maximize"),t&&co(t,"fa-window-minimize","fa-window-maximize")),ha()}function ro(e,t,n){if(da(e)&&da(t)){var a=document.createElement("div"),o=document.createElement("span"),i=document.createElement("span");if(o.textContent=e,o.classList.add("persona"),i.textContent=""+t,i.classList.add("timestamp","mx-1"),"user"===e||"bot"===e){var r=document.createElement("img"),s="bot"===e?ze:Ve,l="bot"===e?"bot-persona":"user-persona",d=document.createElement("span");"bot"===e?d.classList.add("fa","fa-robot"):d.classList.add("fa","fa-user"),o.textContent=s.name,o.classList.add(l),r.classList.add(l),da(s.imageUrl)?(r.src=s.imageUrl,d.classList.add("d-none")):r.classList.add("d-none"),r.addEventListener("error",function(){r.classList.add("d-none"),console.warn("Image not found: "+imageUrl)}),15==z&&a.appendChild(d),a.appendChild(r)}a.appendChild(o),a.appendChild(i),a.classList.add("message-sender","px-3","w-100","mt-2"),n&&a.classList.add("text-right"),M.appendChild(a),He=!0}}function La(e){return e&&"object"===(void 0===e?"undefined":a(e))&&e instanceof Date}function so(e,t){if(La(e)&&La(t)){var n=Math.abs(e.valueOf()-t.valueOf());return Math.floor(n/1e3/60)}return NaN}function lo(){Fa(Pe.ForceFullHeight)}function co(e,t,n){return!!(e&&t&&n&&e.classList.contains(t))&&(e.classList.remove(t),e.classList.add(n),!0)}function uo(e,t,n){if(da(e)&&da(t)){var a=t.match(pe),o=a&&0<a.length?a[0]:null,i=void 0;o&&(t=" "+t.replace(o,"").trim());var r={name:t,imageUrl:o};if(mo(e,"bot")?(ze=r,i="bot-persona"):mo(e,"user")&&(Ve=r,i="user-persona"),!n&&da(i)){var s=Array.from(M.querySelectorAll("span."+i));Array.from(M.querySelectorAll("img."+i)).forEach(function(e){da(r.imageUrl)?(e.src=r.imageUrl,e.classList.remove("d-none")):e.classList.add("d-none")}),s.forEach(function(e){e.textContent=r.name})}}}function po(e){var t=null;if(e&&e.startsWith("icon:")){var n=e.substr(5);n&&(t=document.createElement("span")).classList.add("fa","fa-"+n)}return t}function mo(e,t){return la(e)&&la(t)&&e.toLowerCase()===t.toLowerCase()}function fo(e){var t={};if(e)for(var n=e.split(";"),a=0;a<n.length;a++){var o=n[a];if(o){var i=o.split("=");if(1<i.length){var r=i[0].trim(),s=i[1].trim();t[r]=s}}}return t}function go(e,t,n){if(e){Wo.sanitizeFormTemplate(e);var a=Ma(e,t,n=n||Vt),o=oa();o.classList.add("w-95"),o.appendChild(a),Gn(o),e.fields.forEach(function(e){e.afterAppend&&e.afterAppend()})}else console.warn("Invalid form"),console.warn(e)}function vo(e){var t=[];return e&&(t=JSON.parse(e)),t}function ho(e,t){var n=Lo(e);n.fields.forEach(function(e){e&&e.validationPattern&&So(e.validationPattern)&&(e.validationPattern=e.validationPattern.source)}),ee.push({id:tt++,isUserMessage:!1,message:" ",messageTimestamp:Va(),displayMessage:null,customMessage:{messageType:Ue.Form,values:n,displayName:t}})}function yo(){if(M)for(var e=M.childElementCount;1<e;){var t=M.lastElementChild;M.removeChild(t),e-=1}}function Eo(){ee=[],yo(),Je=[],ha()}function To(e){return e&&"object"===(void 0===e?"undefined":a(e))}function Co(e){return e&&"function"==typeof e}function bo(e){return To(e)&&e instanceof Array}function So(e){return To(e)&&e instanceof RegExp}function xo(e){return 0===Object.keys(e).length}function Lo(t){var n=void 0;return bo(t)?(n=[],t.forEach(function(e){n.push(Lo(e))})):Co(t)||(To(t)?(n={},Object.keys(t).forEach(function(e){n[e]=Lo(t[e])})):n=t),n}function Io(e,t){Gn(wo("⛊ You are now chatting with "+(t||e||"Agent")),"text-strip")}function Mo(e,t){Gn(wo("⛊ "+(t||e||"Agent")+" has left the conversation"),"text-strip")}function wo(e){var t=document.createElement("span");return t.textContent=e,t}function Ao(e){if(e)for(var t=e.lastElementChild;t;)e.removeChild(t),t=e.lastElementChild}function ko(){Z&&(Z.abort(),Z.start(),Lt("event","Button_Speech_Start",Za("user_interaction",null,null)))}function No(){Qt("Caller form","Contact Agent",!1,!1,!1)}function _o(){Z.stop(),Lt("event","Button_Speech_Stop",Za("user_interaction",null,null))}function Oo(e){if(window.speechSynthesis){var t=new SpeechSynthesisUtterance(e);t.lang=te+"-IN",t.pitch=1,t.rate=1,t.volume=1,speechSynthesis.paused&&speechSynthesis.resume(),window.speechSynthesis.speak(t)}}function Ro(e,t,n){var a=new Date,o=String(a.getDate()+e).padStart(2,"0"),i=String(a.getMonth()+t+1).padStart(2,"0");return a=String(a.getFullYear()+n)+"-"+i+"-"+o}function Do(){window.navigator||(window.navigator={});var e=window.navigator.userAgent.toLowerCase(),t="";t=0<=e.indexOf("windows")?"Windows":0<=e.indexOf("linux")?"Linux":0<=e.indexOf("mac")?"macOS":0<=e.indexOf("blackberry")?"BlackBerry":0<=e.indexOf("android")?"Android":0<=e.indexOf("iphone")||0<=e.indexOf("ipad")?"iOS":"unknown";var n="Desktop";return Qa()&&(n="Mobile"),{Browser:window.navigator.browserInfo||"",OperatingSystem:t,Referrer:Ge.pageReferrer||"",Device:n,RawUserAgent:window.navigator.userAgent||"",PageUrl:Ca()||"",PageTitle:Ge.pageTitle||""}}function Po(){var e=[{field:"Name",datatype:"text",errorMessage:"please enter a valid name",isMandatory:!1,image:"icon:user"},{field:"Email",datatype:"email",errorMessage:"please enter a valid email address",validationPattern:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,10}|[0-9]{1,5})(\]?)$/,isMandatory:!1,image:"icon:envelope"},{field:"Mobile",datatype:"tel",errorMessage:"please enter a valid phone number",validationSource:se,isMandatory:!1,image:"icon:phone"}];return{title:Na("Contact Information"),description:Na("Please enter your contact details"),fields:e}}function Bo(e){var t=void 0,n=document.querySelector("#"+e);return n&&(t=document.importNode(n.content.firstElementChild,!0)),t}function Uo(){return{title:"Please upload your file(s)",description:"",fields:[{field:"File",datatype:"file",name:"file",errorMessage:"please select a valid file",isMandatory:!0,addMore:{limit:5}}],tag:"form"}}function Fo(e,t){var n={EventName:e,EventData:t||null};Fa(Pe.CustomEventDispatch,n)}function Ho(e,t,n,a,o,i){Ze||(Ze=[]),Ze.push({botRequest:e,viewRef:t,displayText:n,skipHistory:a,invokeType:o,count:i})}function Vo(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function zo(){return new Date}function qo(e){return("0"+e).slice(-2)}function Go(){var e=document.getElementById("header-content");e.offsetWidth?(x.style.width=e.offsetWidth+"px",x.style.whiteSpace="nowrap"):window.setTimeout(function(){Go()},1e3)}window.dataLayer=window.dataLayer||[],Mt(),$(document).ready(function(){Lt("event",ge.EVENT_DOCUMENT_READY),Fo(Be.Load,{botId:z}),console.debug("BotClient: "+z),C=document.querySelector("#chatWindow"),b=document.querySelector("#chatWindowHeader"),S=document.querySelector("#avatarImage"),x=document.querySelector("#headerTitle"),L=document.querySelector("#headerSubTitle"),I=document.querySelector("#chatWindowBody"),w=document.querySelector("#chatInput"),A=document.querySelector("#chatActions"),k=document.querySelector("#sendButton"),N=document.querySelector("#speechButton"),_=document.querySelector("#callButton"),Qe.headerMenu.container=document.querySelector("#menuContainer"),Qe.footerMenu.container=document.querySelector("#footer-menu"),Qe.footerMenu.optionsContainer=document.querySelector("#footer-menu-options"),Qe.footerMenu.hidden=!0,Qe.footerMenu.container.addEventListener("click",function(){if(Qe.footerMenu.container.classList.contains("footer-minimized"))gn(Qe.footerMenu.contentElement);else{if(Qe.footerMenu.container.classList.remove("open"),Qe.footerMenu.container.classList.add("footer-minimized"),C.classList.remove("footer-menu"),Qe.footerMenu.isOpen=!1,Qe.footerMenu.referenceElement){var e=Qe.footerMenu.optionsContainer.getElementsByClassName("interactive-menu-options");e&&0<e.length&&((e=e[0]).classList.add("d-none"),Qe.footerMenu.referenceElement.appendChild(e))}Qe.footerMenu.hidden&&Qe.footerMenu.container.classList.add("footer-hidden")}}),Qe.footerMenu.closeElement=document.querySelector("#footer-menu-closed"),Qe.footerMenu.contentElement=document.querySelector("#footer-menu-content"),O=document.querySelector("#languageButton"),M=document.querySelector("#messageContainer"),R=document.querySelector("#poweredByText"),D=R.children[0],P=document.querySelector("#chatWindowFooter"),B=document.querySelector("#headerMaximizeMinimizeButton"),U=document.querySelector("#headerCloseButton"),Q=document.querySelector("#stopSpeech"),F={},Go(),W=Ca(),z=xt("botid"),G="1"===xt("test")||0<z.indexOf("-test"),q=xt("userid",W),K=xt("hash"),$e.AvatarImage=(ba()?"":"/botapp")+$e.AvatarImage+z,$e.backgroundImage&&($e.BackgroundImage=(ba()?"":"/botapp")+$e.BackgroundImage+z),jn($e),ae=!1,Y=oe+z+"_"+K,J=ie+z+"_"+K,ee=[],ne=$a(),Ia(ot=ba()),ne||ba()||Lt("event",ge.EVENT_COOKIES_DISABLED,Za("browser_info")),pa();var e=Ea();Fe=e&&e.botUserWebContext?e.botUserWebContext:Fe,Ye.previousStateLoaded=!1,e?(console.debug("Found previous state, restoring.."),ma(e,!0)):(ee=[],console.debug("No previous state found")),Ye.previousStateLoaded=!0;var t=Ta();t?(console.debug("Found previous session state, restoring..."),fa(t),et=!1,t.queryUserDenied&&(q=null)):console.debug("No previous session state found");var n=!1;if(ee&&0!=ee.length){if(t&&t.pageUrl!==W&&(ee.forEach(function(e){e.isUserMessage&&(ae=!0)}),ae?n=!1:(n=!0,Eo()),W&&!W.includes("?"))){var a=t.pageUrl,o=a.indexOf("?");0<o&&(W+=a.substring(o))}}else n=!0;var i=_e+"?botId="+z,r=new XMLHttpRequest;if(r.open("POST",i,!0),r.setRequestHeader("Content-type","application/json"),!j){var s=new URL(window.location.href),l=s.searchParams.keys(),d=!0,c=!(j={}),u=void 0;try{for(var p,m=l[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var f=p.value,g=f;g.startsWith("context-")&&(g=g.substring(8),j[g]=s.searchParams.get(f))}}catch(e){c=!0,u=e}finally{try{!d&&m.return&&m.return()}finally{if(c)throw u}}}var v,h,y,E={IsTest:G,SessionUserId:H,QueryClientUserId:q,ConversationId:V,ConversationLanguage:te||"",TimezoneOffsetMinutes:-1*(new Date).getTimezoneOffset(),SourceUrl:W,TriggerAutoMessage:n,ConversationContext:j},T=JSON.stringify(E);r.onload=function(e){Ct(e)},Lt("event",ge.EVENT_LOAD_CHAT_REQUESTED),ht.requestedAt=new Date,r.send(T),Lt("event",n?ge.EVENT_AUTO_MESSAGE_REQUESTED:ge.EVENT_AUTO_MESSAGE_SKIPPED),(window.hasOwnProperty("webkitSpeechRecognition")||window.hasOwnProperty("SpeechRecognition"))&&((Z=new(window.webkitSpeechRecognition||window.SpeechRecognition)).lang="en-IN",Z.onerror=function(e){"no-speech"===e.error?console.warn("No speech detected"):(It({message:"Speech recognition error: "+e},!1),console.warn(e))},Z.onstart=function(e){console.debug("Speech recognition started"),Yn("Listening... say something"),N.classList.add("blink")},Z.onend=function(e){console.debug("Speech Recognition ended"),Yn(F.PlaceholderText||$e.PlaceholderText),N.classList.remove("blink")},Z.onnomatch=function(e){console.warn("Failed to recognize speech")},Z.onresult=function(e){console.debug("Speech recognition result"),console.debug(e);var t=e.results[0][0].transcript;console.debug("Recognized Speech: '"+t+"'"),da(t)&&(console.debug(t),at=!0,Qt(t,t))},window.speechSynthesis&&(window.speechSynthesis.onerror=function(e){console.error("Error in speech synthesis"),console.error(e),It({message:"Text to speech error: "+e},!1)})),window.navigator&&(window.navigator.browserInfo=(h=navigator.userAgent,y=h.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(y[1])?"IE "+((v=/\brv[ :]+(\d+)/g.exec(h)||[])[1]||""):"Chrome"===y[1]&&null!=(v=h.match(/\b(OPR|Edge)\/(\d+)/))?v.slice(1).join(" ").replace("OPR","Opera"):(y=y[2]?[y[1],y[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(v=h.match(/version\/(\d+)/i))&&y.splice(1,1,v[1]),y.join(" ")))),kt(),X={isConnected:!1,tryingToReconnect:!1},Qa()&&Da(B)});var Wo={getFormDetailsFromCommand:function(e){var t,n,a,o;switch(e.Name){case T.APPOINTMENT_FORM.Trigger:a=(new Date).getTimezoneOffset(),o=Math.abs(a),i={title:"Select Appointment Date and Time UTC"+(a=(a<0?"+":"-")+("00"+Math.floor(o/60)).slice(-2)+":"+("00"+o%60).slice(-2)),description:"",fields:[{field:"Appointment Date",datatype:"datetime",errorMessage:"please select a valid date",isMandatory:!0,readonly:!0,image:"icon:calendar"},{field:"Appointment Time",datatype:"dropdown",errorMessage:"please select a valid time",isMandatory:!0,value:["10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM"],need:"Appointment Date",image:"icon:clock-o"}]},t=vo(e.Value);break;case T.CONTACT_FORM.Trigger:n=[{field:"Name",datatype:"text",errorMessage:"please enter a valid name",isMandatory:!1,image:"icon:user"},{field:"Email",datatype:"email",errorMessage:"please enter a valid email address",validationPattern:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,10}|[0-9]{1,5})(\]?)$/,isMandatory:!1,image:"icon:envelope"},{field:"Mobile",datatype:"tel",errorMessage:"please enter a valid phone number",validationSource:se,isMandatory:!1,image:"icon:phone"}],i={title:Na("Contact Information"),description:Na("Please enter your contact details"),fields:n},t=vo(e.Value);break;case T.ADDRESS_FORM.Trigger:i={title:"Address Information",description:"Please enter your address details",fields:[{field:"Address Line 1",datatype:"text",errorMessage:"please enter a valid address",isMandatory:!0},{field:"Address Line 2",datatype:"text",errorMessage:"please enter a valid address",isMandatory:!1},{field:"City",datatype:"text",errorMessage:"Please enter a valid City",isMandatory:!0,takeHalfRow:!0},{field:"State",datatype:"text",errorMessage:"please enter a valid State",isMandatory:!0,takeHalfRow:!0},{field:"Country",datatype:"text",errorMessage:"please enter a valid Country",isMandatory:!0,takeHalfRow:!0},{field:"Zip Code",datatype:"text",errorMessage:"Please enter a valid Zip Code",validationPattern:/^[1-9][0-9]{5}$/,isMandatory:!0,takeHalfRow:!0}],submit:"address form submission",submitType:"values"},t=vo(e.Value);break;case T.GENERIC_FORM.Trigger:var i;e.Value&&(i=JSON.parse(e.Value))&&(t=vo(i.settings))}return{template:i,setttings:t}},sanitizeFormTemplate:function(e){e&&e.fields&&e.fields.forEach(function(t){t.dataType&&(t.datatype=t.dataType),t.datatype&&("email"===t.datatype?t.validationPattern||(t.validationPattern=Ae.EMAIL_VALIIDATION_PATTERN):"tel"===t.datatype?t.validationSource||(t.validationPattern=Ae.PHONE_VALIDATION_SOURCE):"url"===t.datatype?t.validationSource||(t.validationPattern=Ae.URL_VALIIDATION_PATTERN):"datetime"===t.datatype&&(t.datetimepickersettings?Object.keys({timepicker:!1,format:"d-M-Y",minDate:"-1970/01/1",maxDate:"+1970/06/1",scrollMonth:!1,scrollInput:!1}).forEach(function(e){t.datetimepickersettings[e]||(t.datetimepickersettings[e]=formSettings[t.field].datetimepickersettings[e])}):t.datetimepickersettings={timepicker:!1,format:"d-M-Y",minDate:"-1970/01/1",maxDate:"+1970/06/1",scrollMonth:!1,scrollInput:!1},t.readonly=!0,t.image="icon:calendar",t.afterAppend=function(){this.inputElementRef&&$(this.inputElementRef).datetimepicker(this.datetimepickersettings)}))})}},jo=function(){function r(e){var t=e.getMonth()+1,n=e.getDate();return[e.getFullYear(),(9<t?"":"0")+t,(9<n?"":"0")+n].join("-")}return{getDateKeys:function(e){var t,n,a,o,i=[];return e&&(r(e)==r(new Date)?i.push("today"):(i.push(r(e)),i.push((a=(n=e).getMonth()+1,o=n.getDate(),["****",(9<a?"":"0")+a,(9<o?"":"0")+o].join("-"))),i.push(["****","**",(9<(t=e.getDate())?"":"0")+t].join("-")),i.push(e.getDay()))),i}}}(),$o=function(){var i=150,r="#000000ff",s="#ffffffff",l=/^#[0-9a-f]{6}$/i,d=/^#[0-9a-f]{6}$/i,c=/^#[0-9a-f]{8}$/i,u=/^rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)$/i,p=/^rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*(\d|\d\.\d+)\s*\)$/i;function m(e){if(!e)return e;var t={red:0,green:0,blue:0,alpha:1};if(e=e.trim(),c.test(e))t.red=v(e.substr(1,2)),t.green=v(e.substr(3,2)),t.blue=v(e.substr(5,2)),t.alpha=v(e.substr(7,2));else if(l.test(e))t.red=v(e.substr(1,2)),t.green=v(e.substr(3,2)),t.blue=v(e.substr(5,2));else if(d.test(e))t.red=v(e[1]+"{"+e[1]),t.green=v(e[2]+"{"+e[2]),t.blue=v(e[3]+"{"+e[3]);else if(p.test(e)){var n=h(e," ",""),a=(n=n.substring(n.indexOf("(")+1,n.lastIndexOf(")"))).split(",");t.red=Math.min(parseInt(a[0]),255),t.green=Math.min(parseInt(a[1]),255),t.blue=Math.min(parseInt(a[2]),255),t.alpha=Math.min(parseFloat(a[3]),1)}else if(u.test(e)){var o=h(e," ",""),i=(o=o.substring(o.indexOf("(")+1,o.lastIndexOf(")"))).split(",");t.red=Math.min(parseInt(i[0]),255),t.green=Math.min(parseInt(i[1]),255),t.blue=Math.min(parseInt(i[2]),255),t.alpha=1}else console.warn("color format unsupported: "+e),t=null;return t}function f(e){return e?Math.floor(Math.sqrt(.241*e.red*e.red+.691*e.green*e.green+.068*e.blue*e.blue)):0}function g(e){if(!e)return e;return"#"+y(t(e.red),"0",2)+y(t(e.green),"0",2)+y(t(e.blue),"0",2)+y(t(e.alpha),"0",2)}function t(e){return e.toString(16)}function v(e){return parseInt("0x"+e)}function h(e,t,n){if(e&&t)for(n||(n="");0<=e.indexOf(t);)e=e.replace(t,n);return e}function y(e,t,n){return e&&t&&n&&(e=e.padStart(n,t[0])),e}function E(e,t){3==(e=e.replace(/^\s*#|\s*$/g,"")).length&&(e=e.replace(/(.)/g,"$1$1"));var n=parseInt(e.substr(0,2),16),a=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16),i="#"+y((0|256+n+(256-n)*t/100).toString(16).substr(1),"0",2);return i+=y((0|256+a+(256-a)*t/100).toString(16).substr(1),"0",2),i+=y((0|256+o+(256-o)*t/100).toString(16).substr(1),"0",2)}return{getThemeSettings:function(e,t){var n=null,a=g(m(e));if(a){a=a.substr(0,7),(n={}).color=a;var o=g(m(t));n.backgroundColor=o?(o=o.substr(0,7))===a?(n.colorFrom=a,n.colorTo=o,n.backgroundGradient="linear-gradient(90deg,"+n.colorFrom+","+n.colorTo+")",n.backgroundGradientRev="linear-gradient(270deg,"+n.colorFrom+","+n.colorTo+")",a):(n.colorFrom=a,n.colorTo=o,n.backgroundGradient="linear-gradient(90deg,"+n.colorFrom+","+n.colorTo+")",n.backgroundGradientRev="linear-gradient(270deg,"+n.colorFrom+","+n.colorTo+")",""):(n.colorFrom=E(a,-30),n.colorTo=E(a,30),n.backgroundGradient="linear-gradient(90deg,"+n.colorFrom+","+n.colorTo+")",n.backgroundGradientRev="linear-gradient(270deg,"+n.colorFrom+","+n.colorTo+")",""),n.percievedBrightness=f(m(n.colorFrom)),n.percievedBrightness1=f(m(n.color)),n.percievedBrightness2=f(m(n.colorTo)),n.textColor=n.percievedBrightness<=i?s:r,n.buttonColor=(n.percievedBrightness,r),n.buttonBorderColor=(n.percievedBrightness,a),n.buttonBackgroundColor=(n.percievedBrightness,s),n.buttonColorHover=(n.percievedBrightness,s),n.buttonBackgroundColorHover=n.percievedBrightness<=i?a:"#525252"}return n},getTextColorForBackground:function(e){var t="#000000ff";if(console.debug("Background Color: "+e),!e)return t;var n=m(e);return console.debug("Normalized background color: "),console.debug(n),n&&f(n)<=150?"#ffffffff":t},setAlpha:function(e,t){if(!e||isNaN(t))return e;t=Math.floor(255*Math.min(Math.max(0,t),1));var n=m(e);return n.alpha=t,g(n)},normalizeColor:m,getPercievedBrightness:f,BRIGHTNESS_THRESHOLD:i}}(),Ko={isMessageFitting:function(e,t,n){var a=!0,o=e.cloneNode(!0);if(o.getElementsByClassName(t)){var i=document.getElementById("roughMessageContainer");i.appendChild(o);var r=o.getElementsByClassName("option-pill-container");Array.prototype.forEach.call(r,function(e){var t=e.firstElementChild;t.scrollHeight>t.clientHeight&&(a=!1)}),a||(r=e.getElementsByClassName("option-pill-container"),Array.prototype.forEach.call(r,function(e){e.classList.remove(t),e.classList.add(n)})),i.removeChild(o)}return a},setFittingClassByText:function(e){var t=e.getElementsByClassName("option-pill-container");if(t&&t.length){var i=[];Array.prototype.forEach.call(t,function(e){if(e.textContent){for(var t=0,n=0;n<e.textContent.length;n++){var a=e.textContent.charAt(n);" "==a?t+=4:a==a.toLowerCase()?t+=9:t+=12}var o=1;t<=90?o=3:t<=160&&(o=2),i.push(o)}else i.push(-1)});for(var n=3,a=0;a<i.length;){for(var o=i[a],r=i[a],s=!0,l=1;l<o;l++)a+l<i.length?i[a+l]>=r||(s=!1):s&&0<a&&r==n?(o=l,l+=i[a]):s=!1;if(s){var d="option-pill-"+r;for(l=0;l<o;l++)t[a+l].classList.add(d);a+=o,r<n&&(n=r)}else i[a]=i[a]-1}}}},Jo=function(){function a(){Ln("krazorpay-btn",{Title:"Transaction Completed",RemoveClick:!0,RemoveId:!0})}return{addRazorpayButton:function(t){a();var e={Title:"Make Payment",OnClick:function(e){Fa(Pe.OpenRazorpayForm,t),e.stopPropagation(),Ot()},ElementId:"krazorpay-btn"},n=[];n.push(e),cn({RichCards:n,Text:"Please make the payment",CardsType:Re.SmallButton}),Fa(Pe.OpenRazorpayForm,t),qa(I)},removeRazorpayButton:a}}();function Yo(e){e.Command&&Qo({Type:"UserChat",Command:"StartCall",Data:e})}function Qo(e){Fa(Pe.MediaStreamingCommand,e)}function Zo(e){var t={UserId:H||"",ConversationId:V||"",BotClientName:z||""};l.invoke("OnMediaSignal",e,t).done().fail(function(e){console.error("Message sending failed: "+e)})}function Xo(e){e.style.height="5px",e.style.height=e.scrollHeight+"px",e.style.borderRadius="5px"}